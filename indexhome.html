<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevPro Toolkit - Developer Tools, Code Playground & Format Converter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/ajv@8/dist/2020.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --secondary: #10b981;
            --secondary-dark: #059669;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --border: rgba(148, 163, 184, 0.2);
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Simplified background */
        body::before { display: none; }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
        }

        .site-footer {
            text-align: center;
            margin-top: 1.5rem;
            padding: 1rem 0 0;
            border-top: 1px solid rgba(148, 163, 184, 0.2);
            color: var(--text-secondary);
            font-size: 0.95rem;
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
        }

        .site-footer span {
            color: var(--primary-light);
            font-weight: 600;
            letter-spacing: 0.02em;
        }

        .site-footer a {
            color: var(--primary-light);
            text-decoration: none;
            font-weight: 600;
        }

        .site-footer a:hover {
            text-decoration: underline;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.6s ease-out;
        }

        .logo { margin-bottom: 1rem; }
        .logo-text { font-size: 1.75rem; font-weight: 700; color: var(--text-primary); }

        .tagline {
            color: var(--text-secondary);
            font-size: 1.125rem;
            font-weight: 300;
            margin-top: 0.5rem;
        }

        .privacy-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.875rem;
            margin-top: 1rem;
            color: var(--secondary);
        }

        /* Home Page */
        .home-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
            animation: fadeIn 0.6s ease-out;
        }

        .format-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            width: 100%;
            max-width: 1200px;
            margin-top: 2rem;
        }

        @media (max-width: 1200px) {
            .format-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .format-options {
                grid-template-columns: 1fr;
                max-width: 500px;
            }
        }

        .format-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .format-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, rgba(99, 102, 241, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .format-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.2);
        }

        .format-card:hover::before {
            opacity: 1;
        }

        .format-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .format-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .format-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        /* Editor Page */
        .editor-page {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .editor-page.active {
            display: block;
        }

        .playground-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 1rem;
            min-height: 500px;
        }

        .playground-panel {
            display: flex;
            flex-direction: column;
        }

        .playground-editor-wrapper {
            position: relative;
            flex: 1;
        }

        #playground-editor {
            width: 100%;
            min-height: 500px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
        }

        #playground-output {
            flex: 1;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            overflow-y: auto;
            min-height: 500px;
            white-space: pre-wrap;
            word-break: break-word;
        }

        @media (max-width: 1200px) {
            .playground-grid {
                grid-template-columns: 1fr;
            }

            #playground-editor,
            #playground-output {
                min-height: 400px;
            }
        }

        @media (max-width: 768px) {
            #playground-editor,
            #playground-output {
                min-height: 300px;
            }
        }

        .editor-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .editor-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(51, 65, 85, 0.8);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.625rem 1.25rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: var(--bg-tertiary);
            border-color: var(--text-muted);
            transform: translateX(-4px);
        }

        .editor-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 1024px) {
            .editor-grid {
                grid-template-columns: 1.5fr 3.5fr;
            }
        }

        /* Maximize: single-column full-width panels */
        .editor-grid.maximized { grid-template-columns: 1fr; }
        .editor-grid.maximized .panel-content { min-height: 70vh; }

        .output-panel-large {
            grid-column: 1 / -1;
        }

        .resize-toggle {
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            color: var(--primary-light);
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: 0.5rem;
        }

        .resize-toggle:hover { background: rgba(99, 102, 241, 0.3); }

        .editor-panel {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            background: rgba(51, 65, 85, 0.5);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .panel-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }

        .panel-actions {
            display: flex;
            gap: 0.5rem;
        }

        .icon-button {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            padding: 0.375rem;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 1.125rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-button:hover {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary-light);
        }

        .panel-content {
            padding: 1.5rem;
            flex: 1;
            overflow: auto;
            min-height: 400px;
        }

        .code-input {
            width: 100%;
            min-height: 400px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.2s ease;
        }

        .code-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .code-input::placeholder {
            color: var(--text-muted);
        }

        .code-output {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            min-height: 500px;
            max-height: none;
            overflow: auto;
            white-space: pre;
            word-wrap: break-word;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            font-family: inherit;
        }

        .button-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .button-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(99, 102, 241, 0.4);
        }

        .button-secondary {
            background: rgba(51, 65, 85, 0.8);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .button-secondary:hover {
            background: var(--bg-tertiary);
            border-color: var(--text-muted);
        }

        /* Syntax Highlighting */
        .json-key {
            color: #a5d6ff;
            text-decoration: none;
            border: none;
            background: none;
        }

        .json-string {
            color: #7ee787;
        }

        .json-number {
            color: #f8dfa3;
        }

        .json-boolean {
            color: #ff7b72;
        }

        .json-null {
            color: #ff7b72;
        }

        .xml-tag {
            color: #79c0ff;
        }

        .xml-tag-name {
            color: #7ee787;
            font-weight: 500;
        }

        .xml-attr {
            color: #a5d6ff;
        }

        .xml-value {
            color: #ffa657;
        }

        .xml-text {
            color: var(--text-primary);
        }

        .xml-comment {
            color: #8b949e;
            font-style: italic;
        }

        /* Collapsible Nodes */
        .collapsible-node {
            position: relative;
        }

        .node-toggle {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0 0.25rem;
            margin-right: 0.25rem;
            font-size: 0.75rem;
            transition: all 0.2s ease;
            display: inline-block;
            width: 16px;
            text-align: center;
        }

        .node-toggle:hover {
            color: var(--primary-light);
        }

        .node-content {
            margin-left: 1.5rem;
            border-left: 1px solid rgba(148, 163, 184, 0.1);
            padding-left: 0.75rem;
            display: inline-block;
            vertical-align: top;
        }

        .node-content.collapsed {
            display: none;
        }

        .node-collapsed-indicator {
            color: var(--text-muted);
            font-style: italic;
        }

        /* Path Copy Mode */
        .path-copy-mode .json-key,
        .path-copy-mode .xml-tag-name {
            cursor: pointer;
            position: relative;
        }

        .path-copy-mode .json-key:hover,
        .path-copy-mode .xml-tag-name:hover {
            background: rgba(99, 102, 241, 0.2);
            border-radius: 3px;
            padding: 0 4px;
            margin: 0 -4px;
        }

        .json-path-display {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            color: var(--accent);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            max-width: 400px;
            word-wrap: break-word;
        }

        .json-path-display.active {
            display: block;
            animation: slideInUp 0.3s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Status Messages */
        .status-message {
            padding: 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: slideIn 0.3s ease-out;
        }

        .status-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }

        .status-success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #6ee7b7;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(99, 102, 241, 0.3);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(99, 102, 241, 0.5);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .logo-text {
                font-size: 1.5rem;
            }

            .format-options {
                grid-template-columns: 1fr;
            }

            .editor-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .action-buttons {
                flex-direction: column;
            }

            .button {
                width: 100%;
                justify-content: center;
            }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            background-color: rgba(51, 65, 85, 0.98);
            color: var(--text-primary);
            text-align: center;
            border-radius: 6px;
            padding: 0.5rem 0.75rem;
            position: absolute;
            z-index: 1000;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            font-size: 0.8125rem;
            white-space: nowrap;
            border: 1px solid var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            pointer-events: none;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateX(-50%) translateY(-4px);
        }

        /* Search Bar */
        .search-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-input {
            width: 100%;
            padding: 0.625rem 2.5rem 0.625rem 1rem;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.875rem;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            pointer-events: none;
        }

        .search-stats {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .highlight-match {
            background-color: rgba(245, 158, 11, 0.3);
            border-radius: 2px;
            padding: 0 2px;
        }

        .highlight-current {
            background-color: rgba(245, 158, 11, 0.6);
            border-radius: 2px;
            padding: 0 2px;
        }

        /* Stats Display */
        .stats-display {
            font-size: 0.75rem;
            color: var(--text-secondary);
            padding: 0.5rem 0;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Indent Control */
        .indent-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .indent-control select {
            padding: 0.375rem 0.5rem;
            border-radius: 4px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            font-size: 0.875rem;
            cursor: pointer;
        }

        .indent-control select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* File input hidden */
        .file-input-hidden {
            display: none;
        }

        /* Drag and drop indicator */
        .drag-over {
            border-color: var(--primary) !important;
            background: rgba(99, 102, 241, 0.05) !important;
        }

        /* Compare Mode Styles */
        .compare-mode-toggle {
            margin-bottom: 1rem;
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(51, 65, 85, 0.8);
            transition: 0.3s;
            border-radius: 24px;
            border: 1px solid var(--border);
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .compare-container {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding-bottom: 1rem;
        }

        .compare-container::-webkit-scrollbar {
            height: 8px;
        }

        .compare-container::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 4px;
        }

        .compare-container::-webkit-scrollbar-thumb {
            background: rgba(99, 102, 241, 0.3);
            border-radius: 4px;
        }

        .compare-container::-webkit-scrollbar-thumb:hover {
            background: rgba(99, 102, 241, 0.5);
        }

        .compare-box {
            flex: 0 0 calc(50% - 0.5rem);
            min-width: 450px;
            max-width: 600px;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        @media (max-width: 1024px) {
            .compare-box {
                flex: 0 0 100%;
                max-width: 100%;
                min-width: 300px;
            }
        }

        .compare-box-header {
            background: rgba(51, 65, 85, 0.5);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .compare-box-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }

        .compare-box-content {
            padding: 1.5rem;
            flex: 1;
            overflow: auto;
        }

        .add-compare-btn {
            background: rgba(16, 185, 129, 0.2);
            border: 1px dashed var(--secondary);
            color: var(--secondary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .add-compare-btn:hover {
            background: rgba(16, 185, 129, 0.3);
            border-style: solid;
        }

        .remove-compare-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 0.375rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1rem;
        }

        .remove-compare-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .compare-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* Compression Stats */
        .compression-stats {
            margin-top: 1rem;
            padding: 0.875rem;
            background: rgba(51, 65, 85, 0.4);
            border-radius: 8px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            font-size: 0.8125rem;
        }

        .compression-stats-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .compression-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
        }

        .compression-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .compression-label {
            color: var(--text-secondary);
            font-size: 0.75rem;
        }

        .compression-value {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.9375rem;
        }

        .compression-savings {
            color: var(--secondary);
            font-weight: 700;
        }

        /* Schema Panel */
        .schema-panel {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(51, 65, 85, 0.4);
            border-radius: 8px;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        .schema-panel .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .schema-panel .panel-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .schema-panel .code-input {
            min-height: 150px;
            max-height: 300px;
        }

        /* Developer Tools */
        .tool-tab {
            padding: 0.75rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px 8px 0 0;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .tool-tab:hover {
            background: rgba(51, 65, 85, 0.6);
            color: var(--text-primary);
        }

        .tool-tab.active {
            background: rgba(99, 102, 241, 0.2);
            border-bottom-color: transparent;
            color: var(--primary-light);
        }

        .dev-tool-content {
            display: none;
        }

        .dev-tool-content.active {
            display: block;
        }

        .tool-section {
            background: rgba(30, 41, 59, 0.4);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        /* URL Loader Modal */
        .url-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .url-modal.active {
            display: flex;
        }

        .url-modal-content {
            background: var(--bg-secondary);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .url-modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .url-input {
            width: 100%;
            padding: 0.75rem;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(71, 85, 105, 0.5);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .url-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .url-modal-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
        }

        .diff-added {
            background-color: rgba(16, 185, 129, 0.2);
            border-left: 3px solid var(--secondary);
            padding-left: 0.5rem;
        }

        .diff-removed {
            background-color: rgba(239, 68, 68, 0.2);
            border-left: 3px solid var(--danger);
            padding-left: 0.5rem;
        }

        .diff-modified {
            background-color: rgba(245, 158, 11, 0.2);
            border-left: 3px solid var(--warning);
            padding-left: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <div class="logo-text">DevPro Toolkit</div>
            </div>
            <div class="tagline">All-in-one developer toolkit - beautify, convert, code & test in your browser</div>
            <div class="privacy-badge">
                <span>üîí</span>
                <span>100% Client-Side ‚Ä¢ Zero Data Storage ‚Ä¢ Completely Private</span>
            </div>
        </div>

        <!-- Home Page -->
        <div id="home-page" class="home-page">
            <div class="format-options">
                <div class="format-card" onclick="showEditor('json')">
                    <div class="format-icon">{ }</div>
                    <div class="format-title">JSON Beautifier</div>
                    <div class="format-description">
                        Format, validate, and beautify your JSON data with syntax highlighting and collapsible nodes
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('xml')">
                    <div class="format-icon">&lt;/&gt;</div>
                    <div class="format-title">XML Beautifier</div>
                    <div class="format-description">
                        Format, validate, and beautify your XML documents with intelligent indentation and highlighting
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('crypto')">
                    <div class="format-icon">üîê</div>
                    <div class="format-title">Text Encryption</div>
                    <div class="format-description">
                        Encrypt and decrypt text using AES-256 or Base64 encoding - completely secure and client-side
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('converter')">
                    <div class="format-icon">üîÑ</div>
                    <div class="format-title">Format Converter</div>
                    <div class="format-description">
                        Convert between JSON, XML, YAML, CSV, SQL, TypeScript and more - 14+ format transformations
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('devtools')">
                    <div class="format-icon">üõ†Ô∏è</div>
                    <div class="format-title">Developer Tools</div>
                    <div class="format-description">
                        Password generator, hash tools, JWT decoder, UUID generator, HTTP utilities and more
                    </div>
                </div>
                <div class="format-card" onclick="showEditor('playground')">
                    <div class="format-icon">‚ö°</div>
                    <div class="format-title">Code Playground</div>
                    <div class="format-description">
                        Write and run code in JavaScript, Python, SQL, TypeScript, HTML/CSS - all in your browser
                    </div>
                </div>
            </div>
        </div>

        <!-- JSON Editor -->
        <div id="json-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>{ }</span>
                    <span>JSON Beautifier</span>
                </div>
                <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                    <div class="indent-control">
                        <label for="json-indent">Indent:</label>
                        <select id="json-indent">
                            <option value="2" selected>2 spaces</option>
                            <option value="4">4 spaces</option>
                            <option value="tab">Tab</option>
                        </select>
                    </div>
                    <button class="back-button" onclick="showHome()">
                        <span>‚Üê</span>
                        <span>Back to Home</span>
                    </button>
                </div>
            </div>

            <div class="compare-mode-toggle">
                <label class="toggle-switch">
                    <input type="checkbox" id="json-compare-mode" onchange="toggleCompareMode('json')">
                    <span class="toggle-slider"></span>
                </label>
                <span style="font-size: 0.875rem; color: var(--text-secondary);">Compare Mode</span>
            </div>

            <div id="json-editor-grid" class="editor-grid">
                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Input</div>
                        <div class="panel-actions">
                            <input type="file" id="json-file-input" accept=".json,.txt" class="file-input-hidden">
                            <button class="icon-button tooltip" onclick="document.getElementById('json-file-input').click()">
                                <span>üìÅ</span>
                                <span class="tooltiptext">Upload File</span>
                            </button>
                            <button class="icon-button tooltip" onclick="loadSampleJSON()">
                                <span>üìã</span>
                                <span class="tooltiptext">Load Sample</span>
                            </button>
                            <button class="icon-button tooltip" onclick="clearInput('json')" title="Clear">
                                <span>üóëÔ∏è</span>
                                <span class="tooltiptext">Clear Input</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <textarea 
                            id="json-input" 
                            class="code-input" 
                            placeholder='Paste or drag & drop your JSON here... Example:
{
  "name": "John Doe",
  "age": 30,
  "email": "john@example.com"
}'></textarea>
                        <div class="stats-display" id="json-input-stats"></div>
                    </div>
                </div>

                <div class="editor-panel" id="json-output-panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            Output
                            <button class="resize-toggle" onclick="toggleOutputSize('json')" id="json-resize-btn">Maximize ‚õ∂</button>
                        </div>
                        <div class="panel-actions">
                            <button class="icon-button tooltip" onclick="downloadOutput('json')">
                                <span>üíæ</span>
                                <span class="tooltiptext">Download JSON</span>
                            </button>
                            <button class="icon-button tooltip" onclick="copyOutput('json')">
                                <span>üìã</span>
                                <span class="tooltiptext">Copy to Clipboard</span>
                            </button>
                            <button class="icon-button tooltip" onclick="togglePathMode('json')" id="json-path-btn">
                                <span>üîó</span>
                                <span class="tooltiptext">Enable Path Copy Mode</span>
                            </button>
                            <button class="icon-button tooltip" onclick="toggleExpandAll('json')">
                                <span>‚ö°</span>
                                <span class="tooltiptext">Expand/Collapse All</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="search-container" id="json-search-container" style="display: none;">
                            <input type="text" id="json-search" class="search-input" placeholder="Search in output... (Enter: next, Shift+Enter: prev, Ctrl+F: focus)" onkeyup="searchInOutput('json', event)">
                            <span class="search-icon">üîç</span>
                            <div id="json-search-stats" class="search-stats"></div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem; flex-wrap: wrap; align-items: center;">
                                <label style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; cursor: pointer;">
                                    <input type="checkbox" id="json-search-regex" style="cursor: pointer;">
                                    <span>Regex</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; cursor: pointer;">
                                    <input type="checkbox" id="json-search-case" style="cursor: pointer;">
                                    <span>Case</span>
                                </label>
                                <select id="json-search-scope" style="padding: 0.25rem 0.5rem; font-size: 0.75rem; background: rgba(15, 23, 42, 0.8); color: var(--text-primary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer;">
                                    <option value="all">All</option>
                                    <option value="keys">Keys Only</option>
                                    <option value="values">Values Only</option>
                                </select>
                            </div>
                            <div class="action-buttons" style="margin-top: 0.5rem; gap: 0.5rem;">
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="prevMatch('json')">Prev ‚áß</button>
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="nextMatch('json')">Next ‚á©</button>
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="clearSearch('json')">Clear</button>
                            </div>
                        </div>
                        <div id="json-output" class="code-output">
                            <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                                Your formatted JSON will appear here...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="button button-primary" onclick="beautifyJSON()">
                    <span>‚ú®</span>
                    <span>Beautify JSON</span>
                </button>
                <button class="button button-secondary" onclick="minifyJSON()">
                    <span>üì¶</span>
                    <span>Minify JSON</span>
                </button>
                <button class="button button-secondary" onclick="validateJSON()">
                    <span>‚úì</span>
                    <span>Validate Only</span>
                </button>
                <button class="button button-secondary" onclick="toggleSchemaPanel()">
                    <span>üìã</span>
                    <span>Validate with Schema</span>
                </button>
                <button class="button button-secondary" onclick="autoFormat('json')">
                    <span>üéØ</span>
                    <span>Auto Format</span>
                </button>
                <button class="button button-secondary" onclick="showUrlLoader('json')">
                    <span>üåê</span>
                    <span>Load from URL</span>
                </button>
                <button class="button button-secondary" onclick="quickConvert('json')">
                    <span>üîÑ</span>
                    <span>Convert to...</span>
                </button>
            </div>

            <!-- Schema Validation Panel -->
            <div id="json-schema-panel" class="schema-panel" style="display: none;">
                <div class="panel-header">
                    <div class="panel-title">JSON Schema</div>
                    <button class="icon-button" onclick="toggleSchemaPanel()">‚úï</button>
                </div>
                <div class="panel-content">
                    <textarea id="json-schema-input" class="code-input" placeholder='Enter JSON Schema or click "Load Sample Schema"...'></textarea>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <button class="button button-secondary" onclick="loadSampleSchema()">
                            <span>üìÑ</span>
                            <span>Load Sample Schema</span>
                        </button>
                        <button class="button button-primary" onclick="validateWithSchema()">
                            <span>‚úì</span>
                            <span>Validate Against Schema</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Compression Stats Display -->
            <div id="json-compression-stats" class="compression-stats" style="display: none;"></div>

            <div id="json-compare-container" class="compare-container" style="display: none;">
                <div class="compare-box" id="json-compare-0">
                    <div class="compare-box-header">
                        <div class="compare-box-title">Box 1</div>
                    </div>
                    <div class="compare-box-content">
                        <textarea id="json-compare-input-0" class="code-input" placeholder="Enter JSON..." style="min-height: 300px;"></textarea>
                        <div class="compare-actions">
                            <button class="button button-primary" onclick="beautifyCompare('json', 0)" style="flex: 1;">
                                <span>‚ú®</span>
                                <span>Beautify</span>
                            </button>
                        </div>
                        <div id="json-compare-output-0" class="code-output" style="min-height: 300px; margin-top: 1rem; display: none;"></div>
                    </div>
                </div>
            </div>

            <button id="json-add-compare-btn" class="add-compare-btn" style="display: none; margin-top: 1rem;" onclick="addCompareBox('json')">
                <span>‚ûï</span>
                <span>Add Comparison Box</span>
            </button>
            
            <!-- Path Display Tooltip -->
            <div id="json-path-display" class="json-path-display"></div>
        </div>

        <!-- XML Editor -->
        <div id="xml-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>&lt;/&gt;</span>
                    <span>XML Beautifier</span>
                </div>
                <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                    <div class="indent-control">
                        <label for="xml-indent">Indent:</label>
                        <select id="xml-indent">
                            <option value="2" selected>2 spaces</option>
                            <option value="4">4 spaces</option>
                            <option value="tab">Tab</option>
                        </select>
                    </div>
                    <button class="back-button" onclick="showHome()">
                        <span>‚Üê</span>
                        <span>Back to Home</span>
                    </button>
                </div>
            </div>

            <div class="compare-mode-toggle">
                <label class="toggle-switch">
                    <input type="checkbox" id="xml-compare-mode" onchange="toggleCompareMode('xml')">
                    <span class="toggle-slider"></span>
                </label>
                <span style="font-size: 0.875rem; color: var(--text-secondary);">Compare Mode</span>
            </div>

            <div id="xml-editor-grid" class="editor-grid">
                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Input</div>
                        <div class="panel-actions">
                            <input type="file" id="xml-file-input" accept=".xml,.txt" class="file-input-hidden">
                            <button class="icon-button tooltip" onclick="document.getElementById('xml-file-input').click()">
                                <span>üìÅ</span>
                                <span class="tooltiptext">Upload File</span>
                            </button>
                            <button class="icon-button tooltip" onclick="loadSampleXML()">
                                <span>üìã</span>
                                <span class="tooltiptext">Load Sample</span>
                            </button>
                            <button class="icon-button tooltip" onclick="clearInput('xml')" title="Clear">
                                <span>üóëÔ∏è</span>
                                <span class="tooltiptext">Clear Input</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <textarea 
                            id="xml-input" 
                            class="code-input" 
                            placeholder='Paste or drag & drop your XML here... Example:
<?xml version="1.0"?>
<root>
  <person>
    <name>John Doe</name>
    <age>30</age>
  </person>
</root>'></textarea>
                        <div class="stats-display" id="xml-input-stats"></div>
                    </div>
                </div>

                <div class="editor-panel" id="xml-output-panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            Output
                            <button class="resize-toggle" onclick="toggleOutputSize('xml')" id="xml-resize-btn">Maximize ‚õ∂</button>
                        </div>
                        <div class="panel-actions">
                            <button class="icon-button tooltip" onclick="downloadOutput('xml')">
                                <span>üíæ</span>
                                <span class="tooltiptext">Download XML</span>
                            </button>
                            <button class="icon-button tooltip" onclick="copyOutput('xml')">
                                <span>üìã</span>
                                <span class="tooltiptext">Copy to Clipboard</span>
                            </button>
                            <button class="icon-button tooltip" onclick="toggleExpandAll('xml')">
                                <span>‚ö°</span>
                                <span class="tooltiptext">Expand/Collapse All</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="search-container" id="xml-search-container" style="display: none;">
                            <input type="text" id="xml-search" class="search-input" placeholder="Search in output... (Enter: next, Shift+Enter: prev, Ctrl+F: focus)" onkeyup="searchInOutput('xml', event)">
                            <span class="search-icon">üîç</span>
                            <div id="xml-search-stats" class="search-stats"></div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem; flex-wrap: wrap; align-items: center;">
                                <label style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; cursor: pointer;">
                                    <input type="checkbox" id="xml-search-regex" style="cursor: pointer;">
                                    <span>Regex</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; cursor: pointer;">
                                    <input type="checkbox" id="xml-search-case" style="cursor: pointer;">
                                    <span>Case</span>
                                </label>
                                <select id="xml-search-scope" style="padding: 0.25rem 0.5rem; font-size: 0.75rem; background: rgba(15, 23, 42, 0.8); color: var(--text-primary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer;">
                                    <option value="all">All</option>
                                    <option value="keys">Tags Only</option>
                                    <option value="values">Content Only</option>
                                </select>
                            </div>
                            <div class="action-buttons" style="margin-top: 0.5rem; gap: 0.5rem;">
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="prevMatch('xml')">Prev ‚áß</button>
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="nextMatch('xml')">Next ‚á©</button>
                                <button class="button button-secondary" style="padding: 0.5rem 0.75rem;" onclick="clearSearch('xml')">Clear</button>
                            </div>
                        </div>
                        <div id="xml-output" class="code-output">
                            <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                                Your formatted XML will appear here...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="button button-primary" onclick="beautifyXML()">
                    <span>‚ú®</span>
                    <span>Beautify XML</span>
                </button>
                <button class="button button-secondary" onclick="minifyXML()">
                    <span>üì¶</span>
                    <span>Minify XML</span>
                </button>
                <button class="button button-secondary" onclick="validateXML()">
                    <span>‚úì</span>
                    <span>Validate Only</span>
                </button>
                <button class="button button-secondary" onclick="autoFormat('xml')">
                    <span>üéØ</span>
                    <span>Auto Format</span>
                </button>
                <button class="button button-secondary" onclick="showUrlLoader('xml')">
                    <span>üåê</span>
                    <span>Load from URL</span>
                </button>
                <button class="button button-secondary" onclick="quickConvert('xml')">
                    <span>üîÑ</span>
                    <span>Convert to...</span>
                </button>
            </div>

            <!-- Compression Stats Display -->
            <div id="xml-compression-stats" class="compression-stats" style="display: none;"></div>

            <div id="xml-compare-container" class="compare-container" style="display: none;">
                <div class="compare-box" id="xml-compare-0">
                    <div class="compare-box-header">
                        <div class="compare-box-title">Box 1</div>
                    </div>
                    <div class="compare-box-content">
                        <textarea id="xml-compare-input-0" class="code-input" placeholder="Enter XML..." style="min-height: 300px;"></textarea>
                        <div class="compare-actions">
                            <button class="button button-primary" onclick="beautifyCompare('xml', 0)" style="flex: 1;">
                                <span>‚ú®</span>
                                <span>Beautify</span>
                            </button>
                        </div>
                        <div id="xml-compare-output-0" class="code-output" style="min-height: 300px; margin-top: 1rem; display: none;"></div>
                    </div>
                </div>
            </div>

            <button id="xml-add-compare-btn" class="add-compare-btn" style="display: none; margin-top: 1rem;" onclick="addCompareBox('xml')">
                <span>‚ûï</span>
                <span>Add Comparison Box</span>
            </button>
        </div>

        <!-- Encryption/Decryption Page -->
        <div id="crypto-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>üîê</span>
                    <span>Text Encryption & Decryption</span>
                </div>
                <button class="back-button" onclick="showHome()">
                    <span>‚Üê</span>
                    <span>Back to Home</span>
                </button>
            </div>

            <div class="editor-grid">
                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Input Text</div>
                        <div class="panel-actions">
                            <button class="icon-button tooltip" onclick="clearInput('crypto')">
                                <span>üóëÔ∏è</span>
                                <span class="tooltiptext">Clear Input</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <textarea 
                            id="crypto-input" 
                            class="code-input" 
                            placeholder="Enter your text to encrypt or decrypt..."></textarea>
                        <div class="stats-display" id="crypto-input-stats"></div>
                        
                        <div style="margin-top: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">
                                üîë Secret Key / Password
                            </label>
                            <input 
                                type="password" 
                                id="crypto-key" 
                                class="code-input" 
                                placeholder="Enter your secret key..."
                                style="min-height: auto; padding: 0.75rem; font-family: 'Inter', sans-serif;">
                            <div style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-muted);">
                                üí° Remember this key - you'll need it to decrypt your data
                            </div>
                        </div>

                        <div style="margin-top: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">
                                Algorithm
                            </label>
                            <select id="crypto-algorithm" style="width: 100%; padding: 0.75rem; border-radius: 8px; background: rgba(15, 23, 42, 0.8); color: var(--text-primary); border: 1px solid var(--border); font-size: 0.875rem; cursor: pointer;">
                                <option value="aes">AES-256 (Advanced Encryption Standard)</option>
                                <option value="base64">Base64 (Encoding Only - Not Secure)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="editor-panel">
                    <div class="panel-header">
                        <div class="panel-title">Output</div>
                        <div class="panel-actions">
                            <button class="icon-button tooltip" onclick="downloadOutput('crypto')">
                                <span>üíæ</span>
                                <span class="tooltiptext">Download Output</span>
                            </button>
                            <button class="icon-button tooltip" onclick="copyOutput('crypto')">
                                <span>üìã</span>
                                <span class="tooltiptext">Copy to Clipboard</span>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div id="crypto-output" class="code-output">
                            <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                                Your encrypted/decrypted text will appear here...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="button button-primary" onclick="encryptText()">
                    <span>üîí</span>
                    <span>Encrypt</span>
                </button>
                <button class="button button-secondary" onclick="decryptText()">
                    <span>üîì</span>
                    <span>Decrypt</span>
                </button>
            </div>

            <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(30, 41, 59, 0.6); border: 1px solid var(--border); border-radius: 12px;">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: var(--warning);">
                    <span style="font-size: 1.25rem;">‚ö†Ô∏è</span>
                    <span style="font-weight: 600; font-size: 0.9375rem;">Important Security Notes</span>
                </div>
                <ul style="list-style: none; padding-left: 0; color: var(--text-secondary); font-size: 0.875rem; line-height: 1.8;">
                    <li style="margin-bottom: 0.5rem;">‚úì All encryption happens locally in your browser - no data is sent to any server</li>
                    <li style="margin-bottom: 0.5rem;">‚úì Keep your secret key safe - without it, you cannot decrypt your data</li>
                    <li style="margin-bottom: 0.5rem;">‚úì Base64 is NOT encryption - it's just encoding and can be easily reversed</li>
                    <li style="margin-bottom: 0.5rem;">‚úì AES-256 is military-grade encryption when used with a strong password</li>
                    <li style="margin-bottom: 0.5rem;">‚úì Use a strong, unique password with letters, numbers, and symbols</li>
                </ul>
            </div>
        </div>

        <!-- Format Converter Page -->
        <div id="converter-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>üîÑ</span>
                    <span>Format Converter</span>
                </div>
                <button class="back-button" onclick="showHome()">
                    <span>‚Üê</span>
                    <span>Back to Home</span>
                </button>
            </div>

        <div style="margin-bottom: 1.5rem; text-align: center;">
            <div style="display: inline-block; background: rgba(30, 41, 59, 0.6); padding: 1rem 1.5rem; border-radius: 12px; border: 1px solid var(--border);">
                <label style="display: block; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); font-weight: 500;">
                    Select Conversion Type
                </label>
                <select id="conversion-type" onchange="updateConversionLabels()" style="width: 100%; min-width: 300px; padding: 0.75rem; border-radius: 8px; background: rgba(15, 23, 42, 0.8); color: var(--text-primary); border: 1px solid var(--border); font-size: 0.875rem; cursor: pointer;">
                    <optgroup label="XML ‚Üî JSON">
                        <option value="json-to-xml">JSON ‚Üí XML</option>
                        <option value="xml-to-json">XML ‚Üí JSON</option>
                    </optgroup>
                    <optgroup label="YAML Conversions">
                        <option value="json-to-yaml">JSON ‚Üí YAML</option>
                        <option value="yaml-to-json">YAML ‚Üí JSON</option>
                        <option value="xml-to-yaml">XML ‚Üí YAML</option>
                        <option value="yaml-to-xml">YAML ‚Üí XML</option>
                    </optgroup>
                    <optgroup label="CSV Conversions">
                        <option value="json-to-csv">JSON ‚Üí CSV</option>
                        <option value="csv-to-json">CSV ‚Üí JSON</option>
                        <option value="xml-to-csv">XML ‚Üí CSV</option>
                        <option value="csv-to-xml">CSV ‚Üí XML</option>
                    </optgroup>
                    <optgroup label="Code Generation">
                        <option value="json-to-typescript">JSON ‚Üí TypeScript Interface</option>
                        <option value="json-to-csharp">JSON ‚Üí C# Class</option>
                        <option value="json-to-java">JSON ‚Üí Java Class</option>
                        <option value="json-to-python">JSON ‚Üí Python Dataclass</option>
                        <option value="json-to-go">JSON ‚Üí Go Struct</option>
                        <option value="json-to-schema">JSON ‚Üí JSON Schema</option>
                    </optgroup>
                    <optgroup label="Database & Tables">
                        <option value="json-to-sql">JSON ‚Üí SQL INSERT</option>
                        <option value="csv-to-sql">CSV ‚Üí SQL INSERT</option>
                        <option value="json-to-html">JSON ‚Üí HTML Table</option>
                        <option value="csv-to-html">CSV ‚Üí HTML Table</option>
                        <option value="xml-to-html">XML ‚Üí HTML Table</option>
                        <option value="json-to-markdown">JSON ‚Üí Markdown Table</option>
                        <option value="csv-to-markdown">CSV ‚Üí Markdown Table</option>
                    </optgroup>
                    <optgroup label="Configuration Files">
                        <option value="json-to-ini">JSON ‚Üí INI File</option>
                        <option value="ini-to-json">INI ‚Üí JSON</option>
                    </optgroup>
                    <optgroup label="URL & Web">
                        <option value="json-to-query">JSON ‚Üí URL Query String</option>
                        <option value="query-to-json">URL Query String ‚Üí JSON</option>
                    </optgroup>
                </select>
            </div>
        </div>

        <div class="editor-grid">
            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title" id="converter-input-label">JSON Input</div>
                    <div class="panel-actions">
                        <input type="file" id="converter-file-input" accept=".json,.xml,.yaml,.yml,.csv,.ini,.txt" class="file-input-hidden">
                        <button class="icon-button tooltip" onclick="document.getElementById('converter-file-input').click()">
                            <span>üìÅ</span>
                            <span class="tooltiptext">Upload File</span>
                        </button>
                        <button class="icon-button tooltip" onclick="clearInput('converter')">
                            <span>üóëÔ∏è</span>
                            <span class="tooltiptext">Clear Input</span>
                        </button>
                    </div>
                </div>
                <div class="panel-content">
                    <textarea 
                        id="converter-input" 
                        class="code-input" 
                        placeholder='Paste your data here...'></textarea>
                    <div class="stats-display" id="converter-input-stats"></div>
                </div>
            </div>

            <div class="editor-panel">
                <div class="panel-header">
                    <div class="panel-title" id="converter-output-label">XML Output</div>
                    <div class="panel-actions">
                        <button class="icon-button tooltip" onclick="downloadConverterOutput()">
                            <span>üíæ</span>
                            <span class="tooltiptext">Download</span>
                        </button>
                        <button class="icon-button tooltip" onclick="copyConverterOutput()">
                            <span>üìã</span>
                            <span class="tooltiptext">Copy to Clipboard</span>
                        </button>
                    </div>
                </div>
                <div class="panel-content">
                    <div id="converter-output" class="code-output">
                        <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                            Your converted output will appear here...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="button button-primary" onclick="performConversion()">
                <span>üîÑ</span>
                <span>Convert</span>
            </button>
            <button class="button button-secondary" onclick="swapConversion()">
                <span>‚áÑ</span>
                <span>Swap Direction</span>
            </button>
        </div>

        <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(30, 41, 59, 0.6); border: 1px solid var(--border); border-radius: 12px;">
            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: var(--primary-light);">
                <span style="font-size: 1.25rem;">‚ú®</span>
                <span style="font-weight: 600; font-size: 0.9375rem;">Supported Conversions (25+ formats)</span>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; color: var(--text-secondary); font-size: 0.8125rem;">
                <div>‚úì JSON ‚Üî XML</div>
                <div>‚úì JSON ‚Üî YAML</div>
                <div>‚úì XML ‚Üî YAML</div>
                <div>‚úì JSON ‚Üî CSV</div>
                <div>‚úì XML ‚Üî CSV</div>
                <div>‚úì JSON ‚Üí SQL</div>
                <div>‚úì CSV ‚Üí SQL</div>
                <div>‚úì JSON ‚Üí TypeScript</div>
                <div>‚úì JSON ‚Üí JSON Schema</div>
                <div>‚úì JSON ‚Üî INI</div>
                <div>‚úì JSON ‚Üí HTML Table</div>
                <div>‚úì CSV ‚Üí HTML Table</div>
                <div>‚úì JSON ‚Üí Markdown</div>
                <div>‚úì JSON ‚Üî URL Query</div>
            </div>
        </div>
    </div>
        <!-- Developer Tools Page -->
        <div id="devtools-page" class="editor-page">
            <div class="editor-header">
                <div class="editor-title">
                    <span>üõ†Ô∏è</span>
                    <span>Developer Tools</span>
                </div>
                <button class="back-button" onclick="showHome()">
                    <span>‚Üê</span>
                    <span>Back to Home</span>
                </button>
            </div>

            <div style="padding: 0 1.5rem;">
                <!-- Tool Tabs -->
                <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem; flex-wrap: wrap; border-bottom: 2px solid var(--border); padding-bottom: 0.5rem;">
                    <button class="tool-tab active" onclick="switchDevTool('security')">üîí Security Tools</button>
                    <button class="tool-tab" onclick="switchDevTool('web')">üåê Web Tools</button>
                </div>

                <!-- Security Tools Tab -->
                <div id="security-tools" class="dev-tool-content active">
                <!-- Password Generator -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üîë Password Generator</h3>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="number" id="pwd-length" value="16" min="8" max="64" style="width: 70px; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 4px; color: var(--text-primary);">
                            <span>Length</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="pwd-upper" checked>
                            <span>Uppercase</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="pwd-lower" checked>
                            <span>Lowercase</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="pwd-numbers" checked>
                            <span>Numbers</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="pwd-symbols" checked>
                            <span>Symbols</span>
                        </label>
                    </div>
                    <button class="button button-primary" onclick="generatePassword()">Generate Password</button>
                    <div id="pwd-output" style="margin-top: 1rem; padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; font-family: 'JetBrains Mono', monospace; word-break: break-all; display: none;"></div>
                </div>

                <!-- Hash Generator -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üîê Hash Generator</h3>
                    <textarea id="hash-input" class="code-input" style="min-height: 100px;" placeholder="Enter text to hash..."></textarea>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap;">
                        <button class="button button-secondary" onclick="generateHash('MD5')">MD5</button>
                        <button class="button button-secondary" onclick="generateHash('SHA-1')">SHA-1</button>
                        <button class="button button-secondary" onclick="generateHash('SHA-256')">SHA-256</button>
                        <button class="button button-secondary" onclick="generateHash('SHA-512')">SHA-512</button>
                    </div>
                    <div id="hash-output" style="margin-top: 1rem; padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; font-family: 'JetBrains Mono', monospace; word-break: break-all; display: none;"></div>
                </div>

                <!-- UUID Generator -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üÜî UUID Generator</h3>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                        <button class="button button-primary" onclick="generateUUID()">Generate UUID v4</button>
                        <button class="button button-secondary" onclick="generateBulkUUID()">Generate 10 UUIDs</button>
                    </div>
                    <div id="uuid-output" style="margin-top: 1rem; padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; font-family: 'JetBrains Mono', monospace; display: none;"></div>
                </div>

                <!-- JWT Decoder -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üé´ JWT Decoder</h3>
                    <textarea id="jwt-input" class="code-input" style="min-height: 100px;" placeholder="Paste JWT token here..."></textarea>
                    <button class="button button-primary" onclick="decodeJWT()" style="margin-top: 1rem;">Decode JWT</button>
                    <div id="jwt-output" style="margin-top: 1rem; padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; display: none;"></div>
                </div>
            </div>

            <!-- Web Tools Tab -->
            <div id="web-tools" class="dev-tool-content">
                <!-- HTTP Status Codes -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üì° HTTP Status Code Reference</h3>
                    <input type="text" id="status-search" placeholder="Search status code or description..." style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); margin-bottom: 1rem;" oninput="filterStatusCodes()">
                    <div id="status-codes" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.75rem; max-height: 400px; overflow-y: auto;"></div>
                </div>

                <!-- User-Agent Parser -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üñ•Ô∏è User-Agent Parser</h3>
                    <textarea id="ua-input" class="code-input" style="min-height: 80px;" placeholder="Paste User-Agent string..."></textarea>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <button class="button button-primary" onclick="parseUserAgent()">Parse User-Agent</button>
                        <button class="button button-secondary" onclick="loadCurrentUA()">Use My Browser</button>
                    </div>
                    <div id="ua-output" style="margin-top: 1rem; padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; display: none;"></div>
                </div>

                <!-- URL Parser -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üîó URL Parser</h3>
                    <input type="text" id="url-parse-input" placeholder="Enter URL to parse..." style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary);">
                    <button class="button button-primary" onclick="parseURL()" style="margin-top: 1rem;">Parse URL</button>
                    <div id="url-parse-output" style="margin-top: 1rem; padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; display: none;"></div>
                </div>

                <!-- Base64 Image -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üñºÔ∏è Base64 Image Encoder/Decoder</h3>
                    <input type="file" id="image-file" accept="image/*" style="margin-bottom: 1rem;">
                    <button class="button button-primary" onclick="encodeImage()">Encode to Base64</button>
                    <textarea id="base64-input" class="code-input" style="min-height: 100px; margin-top: 1rem;" placeholder="Or paste Base64 string to decode..."></textarea>
                    <button class="button button-secondary" onclick="decodeImage()" style="margin-top: 0.5rem;">Decode Base64 to Image</button>
                    <div id="image-output" style="margin-top: 1rem; display: none;"></div>
                </div>

                <!-- Certificate Decoder -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üîê Certificate Decoder (X.509)</h3>
                    <textarea id="cert-input" class="code-input" style="min-height: 120px;" placeholder="Paste X.509 certificate (PEM format: -----BEGIN CERTIFICATE-----)"></textarea>
                    <button class="button button-primary" onclick="decodeCertificate()" style="margin-top: 1rem;">Decode Certificate</button>
                    <div id="cert-output" style="margin-top: 1rem; display: none;"></div>
                </div>

                <!-- SSL Certificate Checker -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üîí SSL Certificate Checker</h3>
                    <input type="text" id="ssl-domain" placeholder="Enter domain (e.g., google.com)" style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary);">
                    <button class="button button-primary" onclick="checkSSL()" style="margin-top: 1rem;">Check SSL</button>
                    <div id="ssl-output" style="margin-top: 1rem; display: none;"></div>
                </div>

                <!-- IP Address Lookup -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üåç IP Address Lookup</h3>
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <input type="text" id="ip-address" placeholder="Enter IP or leave blank" style="flex: 1; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary);">
                        <button class="button button-secondary" onclick="getMyIP()">My IP</button>
                    </div>
                    <button class="button button-primary" onclick="lookupIP()">Lookup IP</button>
                    <div id="ip-output" style="margin-top: 1rem; display: none;"></div>
                </div>

                <!-- Domain/DNS Lookup -->
                <div class="tool-section">
                    <h3 style="color: var(--primary-light); margin-bottom: 1rem;">üîç Domain/DNS Lookup</h3>
                    <input type="text" id="dns-domain" placeholder="Enter domain (e.g., example.com)" style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary);">
                    <button class="button button-primary" onclick="lookupDNS()" style="margin-top: 1rem;">Lookup DNS</button>
                    <div id="dns-output" style="margin-top: 1rem; display: none;"></div>
                </div>
            </div>
            </div> <!-- Close padding wrapper -->
        </div>
    </div>

        <!-- Code Playground -->
    <div id="playground-page" class="editor-page">
        <div class="editor-header">
            <button class="back-button" onclick="showHome()">‚Üê Back to Home</button>
            <h2 style="margin: 0; flex: 1;">‚ö° Code Playground</h2>
        </div>

        <div class="editor-container" style="display: block;">
            <!-- Language Selection -->
            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap; background: rgba(15, 23, 42, 0.8); padding: 1rem; border-radius: 12px;">
                <button class="tool-tab active" onclick="switchPlayground('javascript')">JavaScript</button>
                <button class="tool-tab" onclick="switchPlayground('htmlcss')">HTML/CSS</button>
                <button class="tool-tab" onclick="switchPlayground('python')">Python</button>
                <button class="tool-tab" onclick="switchPlayground('sql')">SQL</button>
                <button class="tool-tab" onclick="switchPlayground('typescript')">TypeScript</button>
                <button class="tool-tab" onclick="switchPlayground('json')">JSON Query</button>
            </div>

            <!-- Code Editor & Output -->
            <div class="playground-grid">
                <!-- Editor Panel -->
                <div class="playground-panel">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                        <strong style="color: var(--primary-light);">Code Editor</strong>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="button button-secondary" onclick="loadSample()" style="padding: 0.5rem 1rem; font-size: 0.875rem;">üìù Sample</button>
                            <button class="button button-secondary" onclick="clearPlayground()" style="padding: 0.5rem 1rem; font-size: 0.875rem;">üóëÔ∏è Clear</button>
                            <button class="button button-primary" onclick="runPlaygroundCode()" style="padding: 0.5rem 1.5rem;">‚ñ∂ Run</button>
                        </div>
                    </div>
                    <div class="playground-editor-wrapper">
                        <textarea id="playground-editor" class="code-input" spellcheck="false" placeholder="Write your code here..."></textarea>
                        <div id="autocomplete-dropdown" style="display: none; position: absolute; background: #1f2937; border: 1px solid var(--border); border-radius: 4px; max-height: 200px; overflow-y: auto; z-index: 1000; box-shadow: 0 4px 6px rgba(0,0,0,0.3);"></div>
                    </div>
                </div>

                <!-- Output Panel -->
                <div class="playground-panel">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                        <strong style="color: var(--primary-light);" id="output-label">Output</strong>
                        <button class="button button-secondary" onclick="clearOutput()" style="padding: 0.5rem 1rem; font-size: 0.875rem;">Clear Output</button>
                    </div>
                    <div id="playground-output">
                        <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                            Click "Run" to execute your code...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Python Loading Notice -->
            <div id="python-notice" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 8px; color: #3b82f6;">
                ‚è≥ Loading Python environment (first time only, ~6MB)...
            </div>
        </div>
    </div>

    <!-- URL Loader Modal -->
    <div id="url-modal" class="url-modal">
        <div class="url-modal-content">
            <div class="url-modal-title">üåê Load from URL</div>
            <input type="text" id="url-input" class="url-input" placeholder="Enter URL (e.g., https://api.example.com/data.json)">
            <div class="url-modal-actions">
                <button class="button button-secondary" onclick="closeUrlLoader()">Cancel</button>
                <button class="button button-primary" onclick="loadFromURL()">Load</button>
            </div>
        </div>
    </div>

        <footer class="site-footer">
            <div>¬© <span>@dharsandhanaraj2025</span></div>
            <div>Support us / Email us: <a href="mailto:finedharsan@gmail.com">finedharsan@gmail.com</a></div>
        </footer>
    </div>

    <script>
        // Navigation
        function showEditor(type) {
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('json-page').classList.remove('active');
            document.getElementById('xml-page').classList.remove('active');
            document.getElementById('crypto-page').classList.remove('active');
            document.getElementById('converter-page').classList.remove('active');
            document.getElementById('devtools-page').classList.remove('active');
            document.getElementById('playground-page').classList.remove('active');
            document.getElementById(`${type}-page`).classList.add('active');
            if (type === 'devtools') loadStatusCodes();
            if (type === 'playground') initPlayground();
        }

        function showHome() {
            document.getElementById('home-page').style.display = 'flex';
            document.getElementById('json-page').classList.remove('active');
            document.getElementById('xml-page').classList.remove('active');
            document.getElementById('crypto-page').classList.remove('active');
            document.getElementById('converter-page').classList.remove('active');
            document.getElementById('devtools-page').classList.remove('active');
            document.getElementById('playground-page').classList.remove('active');
        }

        // Utility Functions
        function clearInput(type) {
            document.getElementById(`${type}-input`).value = '';
            const outputMsg = type === 'crypto' ? 'encrypted/decrypted text' : `formatted ${type.toUpperCase()}`;
            document.getElementById(`${type}-output`).innerHTML = `
                <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                    Your ${outputMsg} will appear here...
                </div>
            `;
            updateInputStats(type);
        }

        function copyOutput(type) {
            const output = document.getElementById(`${type}-output`);
            const text = output.innerText || output.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!', 'success');
            }).catch(() => {
                showToast('Failed to copy', 'error');
            });
        }

        function downloadOutput(type) {
            const output = document.getElementById(`${type}-output`);
            const text = output.innerText || output.textContent;
            
            if (!text || text.includes('will appear here')) {
                showToast('No content to download', 'error');
                return;
            }
            
            // Create human-readable date and time
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            
            const dateTime = `${year}${month}${day}_${hours}${minutes}${seconds}`;
            const filename = `formatted-${type}-${dateTime}.${type}`;
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('File downloaded!', 'success');
        }

        function loadSampleJSON() {
            const sample = {
                "user": {
                    "name": "John Doe",
                    "age": 30,
                    "email": "john@example.com",
                    "address": {
                        "street": "123 Main St",
                        "city": "New York",
                        "country": "USA"
                    }
                },
                "hobbies": ["reading", "coding", "gaming"],
                "isActive": true,
                "balance": 1234.56
            };
            document.getElementById('json-input').value = JSON.stringify(sample);
            updateInputStats('json');
            showToast('Sample JSON loaded!', 'success');
        }

        function loadSampleXML() {
            const sample = `<?xml version="1.0" encoding="UTF-8"?>
<catalog>
    <book id="1">
        <title>Learning XML</title>
        <author>John Doe</author>
        <price>29.99</price>
        <published>2024</published>
    </book>
    <book id="2">
        <title>Web Development</title>
        <author>Jane Smith</author>
        <price>39.99</price>
        <published>2023</published>
    </book>
</catalog>`;
            document.getElementById('xml-input').value = sample;
            updateInputStats('xml');
            showToast('Sample XML loaded!', 'success');
        }

        function updateInputStats(type) {
            const input = document.getElementById(`${type}-input`).value;
            const statsDiv = document.getElementById(`${type}-input-stats`);
            
            if (!input.trim()) {
                statsDiv.innerHTML = '';
                return;
            }
            
            const chars = input.length;
            const lines = input.split('\n').length;
            const size = new Blob([input]).size;
            const sizeKB = (size / 1024).toFixed(2);
            
            statsDiv.innerHTML = `
                <div class="stat-item"><strong>Characters:</strong> ${chars.toLocaleString()}</div>
                <div class="stat-item"><strong>Lines:</strong> ${lines.toLocaleString()}</div>
                <div class="stat-item"><strong>Size:</strong> ${sizeKB} KB</div>
            `;
        }

        function setupFileUpload(type) {
            const input = document.getElementById(`${type}-input`);
            const fileInput = document.getElementById(`${type}-file-input`);
            
            // File input change
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        input.value = event.target.result;
                        updateInputStats(type);
                        showToast(`File "${file.name}" loaded!`, 'success');
                    };
                    reader.onerror = function() {
                        showToast('Failed to read file', 'error');
                    };
                    reader.readAsText(file);
                }
                fileInput.value = ''; // Reset file input
            });
            
            // Drag and drop
            input.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('drag-over');
            });
            
            input.addEventListener('dragleave', function(e) {
                this.classList.remove('drag-over');
            });
            
            input.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
                
                const file = e.dataTransfer.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        input.value = event.target.result;
                        updateInputStats(type);
                        showToast(`File "${file.name}" loaded!`, 'success');
                    };
                    reader.onerror = function() {
                        showToast('Failed to read file', 'error');
                    };
                    reader.readAsText(file);
                }
            });
            
            // Update stats on input
            input.addEventListener('input', function() {
                updateInputStats(type);
            });
        }

        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.className = `status-message status-${type}`;
            toast.style.position = 'fixed';
            toast.style.top = '2rem';
            toast.style.right = '2rem';
            toast.style.zIndex = '1000';
            toast.innerHTML = `
                <span>${type === 'success' ? '‚úì' : '‚úï'}</span>
                <span>${message}</span>
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // JSON Functions
        let jsonExpandedState = {};

        function beautifyJSON() {
            const input = document.getElementById('json-input').value.trim();
            const output = document.getElementById('json-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter some JSON data</span>
                    </div>
                `;
                return;
            }

            try {
                const parsed = JSON.parse(input);
                const indentValue = document.getElementById('json-indent').value;
                const indentStr = indentValue === 'tab' ? '\t' : ' '.repeat(parseInt(indentValue));
                
                jsonExpandedState = {};
                output.innerHTML = renderJSON(parsed, 0, 'root', indentStr);
                attachJSONToggleHandlers();
                document.getElementById('json-search-container').style.display = 'block';
                showToast('JSON beautified successfully!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Invalid JSON: ${error.message}</span>
                    </div>
                `;
            }
        }

        function minifyJSON() {
            const input = document.getElementById('json-input').value.trim();
            const output = document.getElementById('json-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter some JSON data</span>
                    </div>
                `;
                return;
            }

            try {
                const parsed = JSON.parse(input);
                const minified = JSON.stringify(parsed);
                output.textContent = minified;
                showToast('JSON minified successfully!', 'success');
                
                // Show compression stats
                updateCompressionStats('json', input, minified);
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Invalid JSON: ${error.message}</span>
                    </div>
                `;
            }
        }

        function validateJSON() {
            const input = document.getElementById('json-input').value.trim();
            const output = document.getElementById('json-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter some JSON data</span>
                    </div>
                `;
                return;
            }

            const warnings = [];
            const suggestions = [];
            
            // Check for duplicate keys
            const dupeKeyRegex = /"([^"]+)"\s*:/g;
            const allKeys = [];
            let match;
            while ((match = dupeKeyRegex.exec(input)) !== null) {
                allKeys.push(match[1]);
            }
            const uniqueKeys = new Set(allKeys);
            if (allKeys.length !== uniqueKeys.size) {
                warnings.push('Duplicate keys detected - later values will override earlier ones');
            }

            // Check for trailing commas
            if (/,\s*[\]}]/.test(input)) {
                warnings.push('Trailing commas found - may cause issues in strict parsers');
            }

            try {
                const parsed = JSON.parse(input);
                
                // Calculate depth and statistics
                let stats = { objects: 0, arrays: 0, maxDepth: 0, size: input.length };
                function calcDepth(obj, depth = 1) {
                    stats.maxDepth = Math.max(stats.maxDepth, depth);
                    if (Array.isArray(obj)) {
                        stats.arrays++;
                        obj.forEach(item => typeof item === 'object' && item !== null && calcDepth(item, depth + 1));
                    } else if (typeof obj === 'object' && obj !== null) {
                        stats.objects++;
                        Object.values(obj).forEach(val => typeof val === 'object' && val !== null && calcDepth(val, depth + 1));
                    }
                }
                calcDepth(parsed);

                if (stats.maxDepth > 5) {
                    suggestions.push(`Deep nesting detected (${stats.maxDepth} levels) - consider flattening structure`);
                }

                let report = `<div class="status-message status-success">
                    <span>‚úì</span>
                    <div style="width: 100%;">
                        <div><strong>Valid JSON!</strong></div>
                        <div style="margin-top: 0.5rem; font-size: 0.875rem;">No syntax errors found.</div>`;
                
                if (warnings.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,165,0,0.1); border-left: 3px solid orange; border-radius: 4px;">
                        <strong style="color: orange;">‚ö† Warnings:</strong><br>
                        ${warnings.map(w => `‚Ä¢ ${w}`).join('<br>')}
                    </div>`;
                }
                
                if (suggestions.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(135,206,250,0.1); border-left: 3px solid skyblue; border-radius: 4px;">
                        <strong style="color: skyblue;">üí° Suggestions:</strong><br>
                        ${suggestions.map(s => `‚Ä¢ ${s}`).join('<br>')}
                    </div>`;
                }
                
                report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,255,255,0.05); border-radius: 4px; font-size: 0.875rem;">
                    <strong>üìä Statistics:</strong><br>
                    Objects: ${stats.objects} | Arrays: ${stats.arrays} | Max Depth: ${stats.maxDepth} | Size: ${stats.size} bytes
                </div>
                    </div>
                </div>`;
                
                output.innerHTML = report;
                showToast('JSON is valid!', 'success');
            } catch (error) {
                let errorDetails = error.message;
                const posMatch = error.message.match(/position (\d+)/);
                
                if (posMatch) {
                    const pos = parseInt(posMatch[1]);
                    const upToError = input.substring(0, pos);
                    const lineNum = upToError.split('\n').length;
                    const colNum = pos - upToError.lastIndexOf('\n');
                    errorDetails = `Error at line ${lineNum}, column ${colNum}: ${error.message}`;
                }
                
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <div>
                            <div><strong>Invalid JSON</strong></div>
                            <div style="margin-top: 0.5rem; font-size: 0.875rem;">${escapeHtml(errorDetails)}</div>
                        </div>
                    </div>
                `;
                showToast('JSON validation failed', 'error');
            }
        }

        // JSON Schema Validation
        function toggleSchemaPanel() {
            const panel = document.getElementById('json-schema-panel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function loadSampleSchema() {
            const sampleSchema = {
                "$schema": "http://json-schema.org/draft-07/schema#",
                "type": "object",
                "properties": {
                    "name": { "type": "string" },
                    "age": { "type": "number", "minimum": 0 },
                    "email": { "type": "string", "format": "email" }
                },
                "required": ["name", "email"]
            };
            document.getElementById('json-schema-input').value = JSON.stringify(sampleSchema, null, 2);
            showToast('Sample schema loaded!', 'success');
        }

        function validateWithSchema() {
            const input = document.getElementById('json-input').value.trim();
            const schemaInput = document.getElementById('json-schema-input').value.trim();
            const output = document.getElementById('json-output');

            if (!input) {
                output.innerHTML = `<div class="status-message status-error"><span>‚úï</span><span>Please enter JSON data</span></div>`;
                return;
            }

            if (!schemaInput) {
                output.innerHTML = `<div class="status-message status-error"><span>‚úï</span><span>Please enter a JSON schema</span></div>`;
                return;
            }

            try {
                const json = JSON.parse(input);
                const schema = JSON.parse(schemaInput);
                
                // Initialize Ajv
                const ajv = new window.ajv2020();
                const validate = ajv.compile(schema);
                const valid = validate(json);

                if (valid) {
                    output.innerHTML = `
                        <div class="status-message status-success">
                            <span>‚úì</span>
                            <div>
                                <div><strong>Valid - Schema Match!</strong></div>
                                <div style="margin-top: 0.5rem; font-size: 0.875rem;">JSON data conforms to the provided schema.</div>
                            </div>
                        </div>`;
                    showToast('Schema validation passed!', 'success');
                } else {
                    let errorReport = `<div class="status-message status-error">
                        <span>‚úï</span>
                        <div style="width: 100%;">
                            <div><strong>Schema Validation Failed</strong></div>
                            <div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(239, 68, 68, 0.15); border-left: 3px solid #ef4444; border-radius: 4px;">
                                <strong style="color: #fca5a5;">Errors:</strong><br>`;
                    
                    validate.errors.forEach((err, idx) => {
                        const path = err.instancePath || '/';
                        errorReport += `<br>${idx + 1}. Path: <code>${path}</code><br>`;
                        errorReport += `   Message: ${err.message}<br>`;
                        if (err.params) {
                            errorReport += `   Details: ${JSON.stringify(err.params)}`;
                        }
                    });
                    
                    errorReport += `</div></div></div>`;
                    output.innerHTML = errorReport;
                    showToast('Schema validation failed', 'error');
                }
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Error: ${escapeHtml(error.message)}</span>
                    </div>`;
                showToast('Validation error', 'error');
            }
        }

        function renderJSON(obj, level, path, indentStr = '  ') {
            const indent = indentStr.repeat(level);
            
            if (obj === null) {
                return `<span class="json-null">null</span>`;
            }

            if (typeof obj === 'boolean') {
                return `<span class="json-boolean">${obj}</span>`;
            }

            if (typeof obj === 'number') {
                return `<span class="json-number">${obj}</span>`;
            }

            if (typeof obj === 'string') {
                return `<span class="json-string">"${escapeHtml(obj)}"</span>`;
            }

            if (Array.isArray(obj)) {
                if (obj.length === 0) {
                    return '[]';
                }

                const nodeId = `json-node-${path}`;
                const isExpanded = jsonExpandedState[nodeId] !== false;
                
                let html = `<span class="collapsible-node">`;
                html += `<button class="node-toggle" data-node="${nodeId}">${isExpanded ? '‚ñº' : '‚ñ∂'}</button>`;
                html += `[`;
                
                if (!isExpanded) {
                    html += `<span class="node-collapsed-indicator"> ... ${obj.length} items </span>`;
                } else {
                    html += `<div class="node-content" id="${nodeId}">`;
                    obj.forEach((item, index) => {
                        html += `\n${indent}${indentStr}${renderJSON(item, level + 1, `${path}[${index}]`, indentStr)}`;
                        if (index < obj.length - 1) html += ',';
                    });
                    html += `\n${indent}</div>`;
                }
                
                html += `]</span>`;
                return html;
            }

            if (typeof obj === 'object') {
                const keys = Object.keys(obj);
                if (keys.length === 0) {
                    return '{}';
                }

                const nodeId = `json-node-${path}`;
                const isExpanded = jsonExpandedState[nodeId] !== false;
                
                let html = `<span class="collapsible-node">`;
                html += `<button class="node-toggle" data-node="${nodeId}">${isExpanded ? '‚ñº' : '‚ñ∂'}</button>`;
                html += `{`;
                
                if (!isExpanded) {
                    html += `<span class="node-collapsed-indicator"> ... ${keys.length} keys </span>`;
                } else {
                    html += `<div class="node-content" id="${nodeId}">`;
                    keys.forEach((key, index) => {
                        const keyPath = path === 'root' ? key : `${path}.${key}`;
                        html += `\n${indent}${indentStr}<span class="json-key" data-path="${keyPath}">"${escapeHtml(key)}"</span>: `;
                        html += renderJSON(obj[key], level + 1, `${path}.${key}`, indentStr);
                        if (index < keys.length - 1) html += ',';
                    });
                    html += `\n${indent}</div>`;
                }
                
                html += `}</span>`;
                return html;
            }

            return String(obj);
        }

        function attachJSONToggleHandlers() {
            document.querySelectorAll('#json-output .node-toggle').forEach(button => {
                button.onclick = function(e) {
                    e.stopPropagation();
                    const nodeId = this.dataset.node;
                    const content = document.getElementById(nodeId);
                    const isCollapsed = content.classList.contains('collapsed');
                    
                    if (isCollapsed) {
                        content.classList.remove('collapsed');
                        this.textContent = '‚ñº';
                        jsonExpandedState[nodeId] = true;
                    } else {
                        content.classList.add('collapsed');
                        this.textContent = '‚ñ∂';
                        jsonExpandedState[nodeId] = false;
                    }
                };
            });
            
            // Attach path copy handlers
            document.querySelectorAll('#json-output .json-key[data-path]').forEach(key => {
                key.onclick = function(e) {
                    if (pathCopyMode) {
                        copyJSONPath(e);
                    }
                };
            });
        }

        function toggleExpandAll(type) {
            const output = document.getElementById(`${type}-output`);
            const contents = output.querySelectorAll('.node-content');
            const toggles = output.querySelectorAll('.node-toggle');
            
            if (contents.length === 0) return;
            
            const firstCollapsed = contents[0].classList.contains('collapsed');
            
            contents.forEach(content => {
                if (firstCollapsed) {
                    content.classList.remove('collapsed');
                } else {
                    content.classList.add('collapsed');
                }
            });
            
            toggles.forEach(toggle => {
                toggle.textContent = firstCollapsed ? '‚ñº' : '‚ñ∂';
            });
        }

        // Path Copy Mode
        let pathCopyMode = false;

        function togglePathMode(type) {
            pathCopyMode = !pathCopyMode;
            const output = document.getElementById(`${type}-output`);
            const btn = document.getElementById(`${type}-path-btn`);
            const tooltip = btn.querySelector('.tooltiptext');
            
            if (pathCopyMode) {
                output.classList.add('path-copy-mode');
                btn.style.background = 'rgba(99, 102, 241, 0.3)';
                tooltip.textContent = 'Disable Path Copy Mode';
                showToast('Path copy mode enabled - click any key to copy its path', 'success');
            } else {
                output.classList.remove('path-copy-mode');
                btn.style.background = '';
                tooltip.textContent = 'Enable Path Copy Mode';
                hidePathDisplay();
            }
        }

        function copyJSONPath(event) {
            if (!pathCopyMode) return;
            
            event.stopPropagation();
            const path = event.target.dataset.path;
            if (!path) return;
            
            // Copy to clipboard
            navigator.clipboard.writeText(path).then(() => {
                showPathDisplay(path);
                showToast(`Path copied: ${path}`, 'success');
            }).catch(err => {
                showToast('Failed to copy path', 'error');
            });
        }

        function showPathDisplay(path) {
            const display = document.getElementById('json-path-display');
            display.textContent = `üìã ${path}`;
            display.classList.add('active');
            
            setTimeout(() => {
                hidePathDisplay();
            }, 3000);
        }

        function hidePathDisplay() {
            const display = document.getElementById('json-path-display');
            display.classList.remove('active');
        }

        // XML Functions
        let xmlExpandedState = {};

        function beautifyXML() {
            const input = document.getElementById('xml-input').value.trim();
            const output = document.getElementById('xml-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter some XML data</span>
                    </div>
                `;
                return;
            }

            try {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(input, 'text/xml');
                
                const parserError = xmlDoc.querySelector('parsererror');
                if (parserError) {
                    throw new Error('Invalid XML structure');
                }

                const indentValue = document.getElementById('xml-indent').value;
                const indentStr = indentValue === 'tab' ? '\t' : ' '.repeat(parseInt(indentValue));

                // Remove whitespace-only text nodes to avoid empty lines
                (function removeEmptyTextNodes(node) {
                    for (let i = node.childNodes.length - 1; i >= 0; i--) {
                        const child = node.childNodes[i];
                        if (child.nodeType === 3) { // TEXT_NODE
                            if (!child.textContent.trim()) node.removeChild(child);
                        } else if (child.nodeType === 1) { // ELEMENT_NODE
                            removeEmptyTextNodes(child);
                        }
                    }
                })(xmlDoc.documentElement);

                xmlExpandedState = {};
                output.innerHTML = renderXML(xmlDoc.documentElement, 0, 'root', indentStr);
                attachXMLToggleHandlers();
                document.getElementById('xml-search-container').style.display = 'block';
                showToast('XML beautified successfully!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Invalid XML: ${error.message}</span>
                    </div>
                `;
            }
        }

        function minifyXML() {
            const input = document.getElementById('xml-input').value.trim();
            const output = document.getElementById('xml-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter some XML data</span>
                    </div>
                `;
                return;
            }

            try {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(input, 'text/xml');
                
                const parserError = xmlDoc.querySelector('parsererror');
                if (parserError) {
                    throw new Error('Invalid XML structure');
                }

                const serializer = new XMLSerializer();
                const minified = serializer.serializeToString(xmlDoc).replace(/>\s+</g, '><');
                output.textContent = minified;
                showToast('XML minified successfully!', 'success');
                
                // Show compression stats
                updateCompressionStats('xml', input, minified);
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Invalid XML: ${error.message}</span>
                    </div>
                `;
            }
        }

        function validateXML() {
            const input = document.getElementById('xml-input').value.trim();
            const output = document.getElementById('xml-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter some XML data</span>
                    </div>
                `;
                return;
            }

            const warnings = [];
            const security = [];
            const suggestions = [];

            // Security scan
            if (/<script[>\s]/i.test(input)) security.push('Script tags detected - potential XSS risk');
            if (/<iframe[>\s]/i.test(input)) security.push('Iframe tags detected - potential injection risk');
            if (/on\w+\s*=/i.test(input)) security.push('Event handlers detected (onclick, onerror, etc.) - security concern');
            if (/<!ENTITY/i.test(input)) security.push('External entities detected - XXE vulnerability risk');

            // Best practices
            if (!/^<\?xml/i.test(input)) warnings.push('Missing XML declaration - consider adding <?xml version="1.0"?>');
            if (/<(\w+)[^>]*>(?!.*<\/\1>)/.test(input.replace(/\/>/g, ''))) {
                warnings.push('Possible unclosed tags detected');
            }

            try {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(input, 'text/xml');
                
                const parserError = xmlDoc.querySelector('parsererror');
                if (parserError) {
                    const errorText = parserError.textContent || 'Invalid XML structure';
                    throw new Error(errorText);
                }

                // Calculate statistics
                const stats = { elements: 0, attributes: 0, maxDepth: 0, size: input.length };
                function analyzeNode(node, depth = 1) {
                    stats.maxDepth = Math.max(stats.maxDepth, depth);
                    if (node.nodeType === 1) {
                        stats.elements++;
                        stats.attributes += node.attributes.length;
                        Array.from(node.childNodes).forEach(child => analyzeNode(child, depth + 1));
                    }
                }
                analyzeNode(xmlDoc.documentElement);

                if (stats.maxDepth > 6) {
                    suggestions.push(`Deep nesting detected (${stats.maxDepth} levels) - consider flattening structure`);
                }

                let report = `<div class="status-message status-success">
                    <span>‚úì</span>
                    <div style="width: 100%;">
                        <div><strong>Valid XML!</strong></div>
                        <div style="margin-top: 0.5rem; font-size: 0.875rem;">No syntax errors found.</div>`;

                if (security.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,0,0,0.15); border-left: 3px solid red; border-radius: 4px;">
                        <strong style="color: #ff6b6b;">üîí Security Alerts:</strong><br>
                        ${security.map(s => `‚Ä¢ ${s}`).join('<br>')}
                    </div>`;
                }
                
                if (warnings.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,165,0,0.1); border-left: 3px solid orange; border-radius: 4px;">
                        <strong style="color: orange;">‚ö† Warnings:</strong><br>
                        ${warnings.map(w => `‚Ä¢ ${w}`).join('<br>')}
                    </div>`;
                }

                if (suggestions.length > 0) {
                    report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(135,206,250,0.1); border-left: 3px solid skyblue; border-radius: 4px;">
                        <strong style="color: skyblue;">üí° Suggestions:</strong><br>
                        ${suggestions.map(s => `‚Ä¢ ${s}`).join('<br>')}
                    </div>`;
                }

                report += `<div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(255,255,255,0.05); border-radius: 4px; font-size: 0.875rem;">
                    <strong>üìä Statistics:</strong><br>
                    Elements: ${stats.elements} | Attributes: ${stats.attributes} | Max Depth: ${stats.maxDepth} | Size: ${stats.size} bytes
                </div>
                    </div>
                </div>`;

                output.innerHTML = report;
                showToast('XML is valid!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <div>
                            <div><strong>Invalid XML</strong></div>
                            <div style="margin-top: 0.5rem; font-size: 0.875rem;">${escapeHtml(error.message)}</div>
                        </div>
                    </div>
                `;
                showToast('XML validation failed', 'error');
            }
        }

        function renderXML(node, level, path, indentStr = '  ') {
            const indent = indentStr.repeat(level);
            
            // Handle text nodes
            if (node.nodeType === 3) {
                const text = node.textContent.trim();
                return text ? `<span class="xml-text">${escapeHtml(text)}</span>` : '';
            }

            // Handle comment nodes
            if (node.nodeType === 8) {
                return `${indent}<span class="xml-comment">&lt;!--${escapeHtml(node.textContent)}--&gt;</span>\n`;
            }

            // Handle element nodes
            if (node.nodeType === 1) {
                const tagName = node.tagName;
                const filteredChildren = Array.from(node.childNodes).filter(n => !(n.nodeType === 3 && !n.textContent.trim()));
                const hasElementChildren = filteredChildren.some(n => n.nodeType === 1);
                const hasTextContent = filteredChildren.length === 1 && filteredChildren[0].nodeType === 3 && filteredChildren[0].textContent.trim();
                
                let html = indent;
                
                // Opening tag
                html += `<span class="xml-tag">&lt;</span>`;
                html += `<span class="xml-tag-name">${tagName}</span>`;
                
                // Attributes
                Array.from(node.attributes).forEach(attr => {
                    html += ` <span class="xml-attr">${attr.name}</span>=`;
                    html += `<span class="xml-value">"${escapeHtml(attr.value)}"</span>`;
                });
                
                html += `<span class="xml-tag">&gt;</span>`;

                // Handle content
                if (hasElementChildren) {
                    const nodeId = `xml-node-${path}`;
                    const isExpanded = xmlExpandedState[nodeId] !== false;
                    
                    html += `<button class="node-toggle" data-node="${nodeId}">${isExpanded ? '‚ñº' : '‚ñ∂'}</button>\n`;
                    
                    if (!isExpanded) {
                        const childCount = filteredChildren.filter(c => c.nodeType === 1).length;
                        html += `<span class="node-collapsed-indicator"> ... ${childCount} child element${childCount > 1 ? 's' : ''} </span>`;
                    } else {
                        html += `<div class="node-content" id="${nodeId}">`;
                        filteredChildren.forEach((child, index) => {
                            let childHtml = renderXML(child, level + 1, `${path}-${index}`, indentStr);
                            if (!childHtml) return;
                            if (!/\n$/.test(childHtml)) childHtml += "\n";
                            html += childHtml;
                        });
                        html += `</div>`;
                    }
                    // no extra indent line to avoid blank lines
                } else if (hasTextContent) {
                    const text = filteredChildren[0].textContent.trim();
                    html += `<span class="xml-text">${escapeHtml(text)}</span>`;
                }

                // Closing tag
                html += `<span class="xml-tag">&lt;/</span>`;
                html += `<span class="xml-tag-name">${tagName}</span>`;
                html += `<span class="xml-tag">&gt;</span>\n`;

                return html;
            }

            return '';
        }

        function attachXMLToggleHandlers() {
            document.querySelectorAll('#xml-output .node-toggle').forEach(button => {
                button.onclick = function(e) {
                    e.stopPropagation();
                    const nodeId = this.dataset.node;
                    const content = document.getElementById(nodeId);
                    const isCollapsed = content.classList.contains('collapsed');
                    
                    if (isCollapsed) {
                        content.classList.remove('collapsed');
                        this.textContent = '‚ñº';
                        xmlExpandedState[nodeId] = true;
                    } else {
                        content.classList.add('collapsed');
                        this.textContent = '‚ñ∂';
                        xmlExpandedState[nodeId] = false;
                    }
                };
            });
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Search Functionality
    let searchMatches = [];
    let currentMatchIndex = -1;

        function searchInOutput(type, event) {
            const searchInput = document.getElementById(`${type}-search`);
            const searchTerm = searchInput.value.trim();
            const output = document.getElementById(`${type}-output`);
            const statsDiv = document.getElementById(`${type}-search-stats`);
            
            // Get advanced search options
            const isRegex = document.getElementById(`${type}-search-regex`)?.checked || false;
            const isCaseSensitive = document.getElementById(`${type}-search-case`)?.checked || false;
            const searchScope = document.getElementById(`${type}-search-scope`)?.value || 'all';

            // Clear previous highlights
            clearSearchHighlights(output);

            if (!searchTerm) {
                statsDiv.textContent = '';
                searchMatches = [];
                currentMatchIndex = -1;
                return;
            }

            // Get text content
            let textContent = output.textContent || output.innerText;
            
            // Apply scope filtering
            if (searchScope === 'keys' || searchScope === 'values') {
                textContent = filterByScope(output, searchScope);
            }
            
            try {
                // Build search pattern
                let pattern = searchTerm;
                if (!isRegex) {
                    pattern = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                }
                
                const flags = isCaseSensitive ? 'g' : 'gi';
                const searchRegex = new RegExp(pattern, flags);
                const matches = textContent.match(searchRegex);

                if (matches && matches.length > 0) {
                    // Highlight all matches
                    highlightMatches(output, searchTerm, isRegex, isCaseSensitive, searchScope);
                    // Collect positions of all marks for navigation
                    searchMatches = Array.from(output.querySelectorAll('mark.highlight-match'));
                    currentMatchIndex = 0;
                    setCurrentMatch(output, currentMatchIndex);
                    statsDiv.textContent = `Found ${matches.length} match${matches.length > 1 ? 'es' : ''} ‚Äî showing 1 of ${matches.length}`;
                    statsDiv.style.color = 'var(--secondary)';
                    // Enter / Shift+Enter navigation
                    if (event && event.key === 'Enter') {
                        if (event.shiftKey) prevMatch(type); else nextMatch(type);
                    }
                } else {
                    statsDiv.textContent = 'No matches found';
                    statsDiv.style.color = 'var(--text-muted)';
                }
            } catch (e) {
                statsDiv.textContent = 'Invalid regex pattern';
                statsDiv.style.color = 'var(--danger)';
            }
        }
        
        function filterByScope(element, scope) {
            let filteredText = '';
            const isJSON = element.querySelector('.json-key') !== null;
            
            if (scope === 'keys') {
                const keyElements = element.querySelectorAll(isJSON ? '.json-key' : '.xml-tag-name');
                keyElements.forEach(el => filteredText += el.textContent + ' ');
            } else if (scope === 'values') {
                const valueElements = element.querySelectorAll(isJSON ? '.json-string, .json-number, .json-boolean, .json-null' : '.xml-text');
                valueElements.forEach(el => filteredText += el.textContent + ' ');
            }
            
            return filteredText;
        }

        function highlightMatches(element, searchTerm, isRegex, isCaseSensitive, searchScope) {
            if (!searchTerm) return;
            
            let pattern = searchTerm;
            if (!isRegex) {
                pattern = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }
            const flags = isCaseSensitive ? 'g' : 'gi';
            const regex = new RegExp(`(${pattern})`, flags);

            const walkTextNodes = (node) => {
                if (node.nodeType === 3) { // Text node
                    // Check scope
                    if (searchScope !== 'all') {
                        const parent = node.parentElement;
                        const isJSON = element.querySelector('.json-key') !== null;
                        
                        if (searchScope === 'keys') {
                            const isKey = parent?.classList.contains('json-key') || parent?.classList.contains('xml-tag-name');
                            if (!isKey) return;
                        } else if (searchScope === 'values') {
                            const isValue = parent?.classList.contains('json-string') || 
                                          parent?.classList.contains('json-number') || 
                                          parent?.classList.contains('json-boolean') || 
                                          parent?.classList.contains('json-null') ||
                                          parent?.classList.contains('xml-text');
                            if (!isValue) return;
                        }
                    }
                    
                    const text = node.textContent;
                    if (regex.test(text)) {
                        const span = document.createElement('span');
                        span.innerHTML = text.replace(regex, '<mark class="highlight-match">$1</mark>');
                        node.parentNode.replaceChild(span, node);
                    }
                } else if (node.nodeType === 1 && node.nodeName !== 'SCRIPT' && node.nodeName !== 'STYLE') {
                    Array.from(node.childNodes).forEach(walkTextNodes);
                }
            };

            walkTextNodes(element);
        }

        function setCurrentMatch(output, index) {
            // Clear previous current
            output.querySelectorAll('mark.highlight-current').forEach(m => m.classList.remove('highlight-current'));
            const marks = output.querySelectorAll('mark.highlight-match');
            if (!marks.length) return;
            const i = Math.max(0, Math.min(index, marks.length - 1));
            const current = marks[i];
            current.classList.add('highlight-current');
            current.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function nextMatch(type) {
            const output = document.getElementById(`${type}-output`);
            const statsDiv = document.getElementById(`${type}-search-stats`);
            const marks = output.querySelectorAll('mark.highlight-match');
            if (!marks.length) return;
            currentMatchIndex = (currentMatchIndex + 1) % marks.length;
            setCurrentMatch(output, currentMatchIndex);
            statsDiv.textContent = `Found ${marks.length} matches ‚Äî showing ${currentMatchIndex + 1} of ${marks.length}`;
            statsDiv.style.color = 'var(--secondary)';
        }

        function prevMatch(type) {
            const output = document.getElementById(`${type}-output`);
            const statsDiv = document.getElementById(`${type}-search-stats`);
            const marks = output.querySelectorAll('mark.highlight-match');
            if (!marks.length) return;
            currentMatchIndex = (currentMatchIndex - 1 + marks.length) % marks.length;
            setCurrentMatch(output, currentMatchIndex);
            statsDiv.textContent = `Found ${marks.length} matches ‚Äî showing ${currentMatchIndex + 1} of ${marks.length}`;
            statsDiv.style.color = 'var(--secondary)';
        }

        function clearSearch(type) {
            const output = document.getElementById(`${type}-output`);
            const statsDiv = document.getElementById(`${type}-search-stats`);
            clearSearchHighlights(output);
            searchMatches = [];
            currentMatchIndex = -1;
            statsDiv.textContent = '';
        }

        function clearSearchHighlights(element) {
            const marks = element.querySelectorAll('mark.highlight-match, mark.highlight-current');
            marks.forEach(mark => {
                const parent = mark.parentNode;
                parent.replaceChild(document.createTextNode(mark.textContent), mark);
                parent.normalize();
            });
        }

        // Keyboard shortcut for search (Ctrl+F)
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                const jsonPage = document.getElementById('json-page');
                const xmlPage = document.getElementById('xml-page');
                
                if (jsonPage.classList.contains('active')) {
                    e.preventDefault();
                    document.getElementById('json-search').focus();
                } else if (xmlPage.classList.contains('active')) {
                    e.preventDefault();
                    document.getElementById('xml-search').focus();
                }
            }
        });

        // Toggle output panel size (maximize/restore)
        function toggleOutputSize(type) {
            const panel = document.getElementById(`${type}-output-panel`);
            const button = document.getElementById(`${type}-resize-btn`);
            const grid = panel.parentElement;
            
            if (panel.classList.contains('output-panel-large')) {
                panel.classList.remove('output-panel-large');
                grid.classList.remove('maximized');
                button.textContent = 'Maximize ‚õ∂';
                button.style.background = 'rgba(99, 102, 241, 0.2)';
            } else {
                panel.classList.add('output-panel-large');
                grid.classList.add('maximized');
                button.textContent = 'Restore ‚õ∂';
                button.style.background = 'rgba(16, 185, 129, 0.2)';
                button.style.borderColor = 'var(--secondary)';
                button.style.color = 'var(--secondary)';
            }
        }

        // Initialize file upload and stats on page load
        document.addEventListener('DOMContentLoaded', function() {
            setupFileUpload('json');
            setupFileUpload('xml');
            
            // Setup crypto input stats
            const cryptoInput = document.getElementById('crypto-input');
            if (cryptoInput) {
                cryptoInput.addEventListener('input', function() {
                    updateInputStats('crypto');
                });
            }
            
            // Setup converter file upload and stats
            const converterInput = document.getElementById('converter-input');
            const converterFileInput = document.getElementById('converter-file-input');
            
            if (converterFileInput) {
                converterFileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            converterInput.value = event.target.result;
                            updateInputStats('converter');
                            showToast(`File "${file.name}" loaded!`, 'success');
                        };
                        reader.readAsText(file);
                    }
                    converterFileInput.value = '';
                });
            }
            
            if (converterInput) {
                converterInput.addEventListener('input', function() {
                    updateInputStats('converter');
                });
            }
            
            // Handle algorithm change to show/hide password requirement
            const algoSelect = document.getElementById('crypto-algorithm');
            if (algoSelect) {
                algoSelect.addEventListener('change', function() {
                    const keyInput = document.getElementById('crypto-key');
                    const keyContainer = keyInput.parentElement;
                    const helpText = keyContainer.querySelector('div');
                    
                    if (this.value === 'base64') {
                        keyContainer.style.opacity = '0.5';
                        keyInput.disabled = true;
                        helpText.innerHTML = 'üí° Base64 doesn\'t use a password - it\'s just encoding, not encryption';
                    } else {
                        keyContainer.style.opacity = '1';
                        keyInput.disabled = false;
                        helpText.innerHTML = 'üí° Remember this key - you\'ll need it to decrypt your data';
                    }
                });
            }
        });

        // Encryption/Decryption Functions
        function encryptText() {
            const input = document.getElementById('crypto-input').value.trim();
            const key = document.getElementById('crypto-key').value;
            const algorithm = document.getElementById('crypto-algorithm').value;
            const output = document.getElementById('crypto-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter text to encrypt</span>
                    </div>
                `;
                return;
            }

            if (!key && algorithm === 'aes') {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter a secret key for AES encryption</span>
                    </div>
                `;
                return;
            }

            try {
                let encrypted;
                
                if (algorithm === 'base64') {
                    encrypted = btoa(unescape(encodeURIComponent(input)));
                    output.innerHTML = `
                        <div class="status-message status-success" style="margin-bottom: 1rem;">
                            <span>‚úì</span>
                            <span>Text encoded successfully with Base64 (No password needed)</span>
                        </div>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-primary);">${escapeHtml(encrypted)}</pre>
                    `;
                } else if (algorithm === 'aes') {
                    encrypted = simpleAESEncrypt(input, key);
                    output.innerHTML = `
                        <div class="status-message status-success" style="margin-bottom: 1rem;">
                            <span>‚úì</span>
                            <span>Text encrypted successfully with AES-256</span>
                        </div>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-primary);">${escapeHtml(encrypted)}</pre>
                    `;
                }
                
                showToast('Encryption successful!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Encryption failed: ${escapeHtml(error.message)}</span>
                    </div>
                `;
                showToast('Encryption failed', 'error');
            }
        }

        function decryptText() {
            const input = document.getElementById('crypto-input').value.trim();
            const key = document.getElementById('crypto-key').value;
            const algorithm = document.getElementById('crypto-algorithm').value;
            const output = document.getElementById('crypto-output');

            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter text to decrypt</span>
                    </div>
                `;
                return;
            }

            if (!key && algorithm === 'aes') {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter the secret key used for encryption</span>
                    </div>
                `;
                return;
            }

            try {
                let decrypted;
                
                if (algorithm === 'base64') {
                    decrypted = decodeURIComponent(escape(atob(input)));
                    output.innerHTML = `
                        <div class="status-message status-success" style="margin-bottom: 1rem;">
                            <span>‚úì</span>
                            <span>Text decoded successfully from Base64 (No password needed)</span>
                        </div>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-primary);">${escapeHtml(decrypted)}</pre>
                    `;
                } else if (algorithm === 'aes') {
                    decrypted = simpleAESDecrypt(input, key);
                    output.innerHTML = `
                        <div class="status-message status-success" style="margin-bottom: 1rem;">
                            <span>‚úì</span>
                            <span>Text decrypted successfully with AES-256</span>
                        </div>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-primary);">${escapeHtml(decrypted)}</pre>
                    `;
                }
                
                showToast('Decryption successful!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <div>
                            <div><strong>Decryption failed</strong></div>
                            <div style="margin-top: 0.5rem; font-size: 0.875rem;">
                                ${escapeHtml(error.message)}
                                <br><br>
                                Possible reasons:<br>
                                ‚Ä¢ Wrong secret key/password<br>
                                ‚Ä¢ Corrupted encrypted data<br>
                                ‚Ä¢ Wrong algorithm selected
                            </div>
                        </div>
                    </div>
                `;
                showToast('Decryption failed', 'error');
            }
        }

        // Simple AES-like encryption using XOR cipher with key derivation
        function simpleAESEncrypt(text, key) {
            const derivedKey = deriveKey(key);
            let encrypted = '';
            
            for (let i = 0; i < text.length; i++) {
                const charCode = text.charCodeAt(i);
                const keyChar = derivedKey.charCodeAt(i % derivedKey.length);
                encrypted += String.fromCharCode(charCode ^ keyChar);
            }
            
            return btoa(unescape(encodeURIComponent(encrypted)));
        }

        function simpleAESDecrypt(encryptedBase64, key) {
            const derivedKey = deriveKey(key);
            const encrypted = decodeURIComponent(escape(atob(encryptedBase64)));
            let decrypted = '';
            
            for (let i = 0; i < encrypted.length; i++) {
                const charCode = encrypted.charCodeAt(i);
                const keyChar = derivedKey.charCodeAt(i % derivedKey.length);
                decrypted += String.fromCharCode(charCode ^ keyChar);
            }
            
            return decrypted;
        }

        function deriveKey(password) {
            let hash = 0;
            for (let i = 0; i < password.length; i++) {
                const char = password.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            
            let derived = password;
            for (let i = 0; i < 10; i++) {
                derived += String.fromCharCode((hash + i * 17) % 256);
            }
            
            return derived;
        }

        // Compare Mode Functionality
        let compareBoxCount = { json: 1, xml: 1 };

        function toggleCompareMode(type) {
            const isCompareMode = document.getElementById(`${type}-compare-mode`).checked;
            const normalGrid = document.getElementById(`${type}-editor-grid`);
            const compareContainer = document.getElementById(`${type}-compare-container`);
            const addBtn = document.getElementById(`${type}-add-compare-btn`);
            const actionButtons = normalGrid.nextElementSibling;

            if (isCompareMode) {
                normalGrid.style.display = 'none';
                compareContainer.style.display = 'flex';
                addBtn.style.display = 'inline-flex';
                actionButtons.style.display = 'none';
                
                const mainInput = document.getElementById(`${type}-input`).value;
                if (mainInput) {
                    document.getElementById(`${type}-compare-input-0`).value = mainInput;
                }
            } else {
                normalGrid.style.display = 'grid';
                compareContainer.style.display = 'none';
                addBtn.style.display = 'none';
                actionButtons.style.display = 'flex';
                
                compareContainer.innerHTML = `
                    <div class="compare-box" id="${type}-compare-0">
                        <div class="compare-box-header">
                            <div class="compare-box-title">Box 1</div>
                        </div>
                        <div class="compare-box-content">
                            <textarea id="${type}-compare-input-0" class="code-input" placeholder="Enter ${type.toUpperCase()}..." style="min-height: 300px;"></textarea>
                            <div class="compare-actions">
                                <button class="button button-primary" onclick="beautifyCompare('${type}', 0)" style="flex: 1;">
                                    <span>‚ú®</span>
                                    <span>Beautify</span>
                                </button>
                            </div>
                            <div id="${type}-compare-output-0" class="code-output" style="min-height: 300px; margin-top: 1rem; display: none;"></div>
                        </div>
                    </div>
                `;
                compareBoxCount[type] = 1;
            }
        }

        function addCompareBox(type) {
            const container = document.getElementById(`${type}-compare-container`);
            const boxId = compareBoxCount[type];
            
            const newBox = document.createElement('div');
            newBox.className = 'compare-box';
            newBox.id = `${type}-compare-${boxId}`;
            newBox.innerHTML = `
                <div class="compare-box-header">
                    <div class="compare-box-title">Box ${boxId + 1}</div>
                    <button class="remove-compare-btn" onclick="removeCompareBox('${type}', ${boxId})">‚úï</button>
                </div>
                <div class="compare-box-content">
                    <textarea id="${type}-compare-input-${boxId}" class="code-input" placeholder="Enter ${type.toUpperCase()} to compare..." style="min-height: 300px;"></textarea>
                    <div class="compare-actions">
                        <button class="button button-primary" onclick="beautifyCompare('${type}', ${boxId})" style="flex: 1;">
                            <span>‚ú®</span>
                            <span>Beautify</span>
                        </button>
                        <button class="button button-secondary" onclick="compareWithPrevious('${type}', ${boxId})" style="flex: 1;">
                            <span>üîç</span>
                            <span>Compare</span>
                        </button>
                    </div>
                    <div id="${type}-compare-output-${boxId}" class="code-output" style="min-height: 300px; margin-top: 1rem; display: none;"></div>
                </div>
            `;
            
            container.appendChild(newBox);
            compareBoxCount[type]++;
            showToast('Comparison box added!', 'success');
        }

        function removeCompareBox(type, boxId) {
            const box = document.getElementById(`${type}-compare-${boxId}`);
            if (box) {
                box.remove();
                showToast('Comparison box removed', 'success');
            }
        }

        function beautifyCompare(type, boxId) {
            const input = document.getElementById(`${type}-compare-input-${boxId}`).value.trim();
            const output = document.getElementById(`${type}-compare-output-${boxId}`);
            
            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter some ${type.toUpperCase()} data</span>
                    </div>
                `;
                output.style.display = 'block';
                return;
            }
            
            try {
                if (type === 'json') {
                    const parsed = JSON.parse(input);
                    const indentValue = document.getElementById('json-indent').value;
                    const indentStr = indentValue === 'tab' ? '\t' : ' '.repeat(parseInt(indentValue));
                    output.innerHTML = renderJSON(parsed, 0, `compare-${boxId}`, indentStr);
                    attachJSONToggleHandlers();
                } else if (type === 'xml') {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(input, 'text/xml');
                    
                    const parserError = xmlDoc.querySelector('parsererror');
                    if (parserError) {
                        throw new Error('Invalid XML structure');
                    }
                    
                    const indentValue = document.getElementById('xml-indent').value;
                    const indentStr = indentValue === 'tab' ? '\t' : ' '.repeat(parseInt(indentValue));
                    
                    (function removeEmptyTextNodes(node) {
                        for (let i = node.childNodes.length - 1; i >= 0; i--) {
                            const child = node.childNodes[i];
                            if (child.nodeType === 3) {
                                if (!child.textContent.trim()) node.removeChild(child);
                            } else if (child.nodeType === 1) {
                                removeEmptyTextNodes(child);
                            }
                        }
                    })(xmlDoc.documentElement);
                    
                    output.innerHTML = renderXML(xmlDoc.documentElement, 0, `compare-${boxId}`, indentStr);
                    attachXMLToggleHandlers();
                }
                
                output.style.display = 'block';
                showToast(`${type.toUpperCase()} beautified!`, 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Invalid ${type.toUpperCase()}: ${escapeHtml(error.message)}</span>
                    </div>
                `;
                output.style.display = 'block';
            }
        }

        function compareWithPrevious(type, currentBoxId) {
            const prevBoxId = currentBoxId - 1;
            const currentOutput = document.getElementById(`${type}-compare-output-${currentBoxId}`);
            const prevOutput = document.getElementById(`${type}-compare-output-${prevBoxId}`);
            
            if (!currentOutput || !prevOutput) {
                showToast('Please beautify both boxes first', 'error');
                return;
            }
            
            const currentText = currentOutput.textContent || '';
            const prevText = prevOutput.textContent || '';
            
            if (!currentText || !prevText || currentText.includes('Please enter') || prevText.includes('Please enter')) {
                showToast('Please beautify both boxes before comparing', 'error');
                return;
            }
            
            const currentLines = currentText.split('\n');
            const prevLines = prevText.split('\n');
            
            let differences = 0;
            const maxLines = Math.max(currentLines.length, prevLines.length);
            
            let prevHighlighted = '';
            let currentHighlighted = '';
            
            for (let i = 0; i < maxLines; i++) {
                const prevLine = prevLines[i] || '';
                const currentLine = currentLines[i] || '';
                
                if (prevLine !== currentLine) {
                    differences++;
                    
                    if (prevLine && !currentLine) {
                        prevHighlighted += `<div class="diff-removed">${escapeHtml(prevLine)}</div>\n`;
                        currentHighlighted += '\n';
                    } else if (!prevLine && currentLine) {
                        prevHighlighted += '\n';
                        currentHighlighted += `<div class="diff-added">${escapeHtml(currentLine)}</div>\n`;
                    } else {
                        prevHighlighted += `<div class="diff-modified">${escapeHtml(prevLine)}</div>\n`;
                        currentHighlighted += `<div class="diff-modified">${escapeHtml(currentLine)}</div>\n`;
                    }
                } else {
                    prevHighlighted += escapeHtml(prevLine) + '\n';
                    currentHighlighted += escapeHtml(currentLine) + '\n';
                }
            }
            
            if (differences === 0) {
                showToast('‚úì No differences found - outputs are identical!', 'success');
                return;
            }
            
            prevOutput.innerHTML = `<pre style="margin: 0; white-space: pre-wrap; word-break: break-all; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; line-height: 1.6;">${prevHighlighted}</pre>`;
            currentOutput.innerHTML = `<pre style="margin: 0; white-space: pre-wrap; word-break: break-all; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem; line-height: 1.6;">${currentHighlighted}</pre>`;
            
            const legend = `
                <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(51, 65, 85, 0.5); border-radius: 8px; font-size: 0.75rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Found ${differences} difference${differences > 1 ? 's' : ''}:</div>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <div><span style="display: inline-block; width: 12px; height: 12px; background: rgba(16, 185, 129, 0.2); border-left: 3px solid var(--secondary); margin-right: 0.25rem;"></span> Added</div>
                        <div><span style="display: inline-block; width: 12px; height: 12px; background: rgba(239, 68, 68, 0.2); border-left: 3px solid var(--danger); margin-right: 0.25rem;"></span> Removed</div>
                        <div><span style="display: inline-block; width: 12px; height: 12px; background: rgba(245, 158, 11, 0.2); border-left: 3px solid var(--warning); margin-right: 0.25rem;"></span> Modified</div>
                    </div>
                </div>
            `;
            
            currentOutput.innerHTML += legend;
            
            showToast(`Found ${differences} difference${differences > 1 ? 's' : ''}`, 'success');
        }

        // ============= FORMAT CONVERTER - PHASE 2 =============

        function updateConversionLabels() {
            const type = document.getElementById('conversion-type').value;
            const inputLabel = document.getElementById('converter-input-label');
            const outputLabel = document.getElementById('converter-output-label');
            
            const labels = {
                'json-to-xml': ['JSON Input', 'XML Output'],
                'xml-to-json': ['XML Input', 'JSON Output'],
                'json-to-yaml': ['JSON Input', 'YAML Output'],
                'yaml-to-json': ['YAML Input', 'JSON Output'],
                'xml-to-yaml': ['XML Input', 'YAML Output'],
                'yaml-to-xml': ['YAML Input', 'XML Output'],
                'json-to-csv': ['JSON Input', 'CSV Output'],
                'csv-to-json': ['CSV Input', 'JSON Output'],
                'xml-to-csv': ['XML Input', 'CSV Output'],
                'csv-to-xml': ['CSV Input', 'XML Output'],
                'json-to-typescript': ['JSON Input', 'TypeScript Interface'],
                'json-to-schema': ['JSON Input', 'JSON Schema'],
                'json-to-sql': ['JSON Input', 'SQL INSERT'],
                'csv-to-sql': ['CSV Input', 'SQL INSERT'],
                'json-to-html': ['JSON Input', 'HTML Table'],
                'csv-to-html': ['CSV Input', 'HTML Table'],
                'xml-to-html': ['XML Input', 'HTML Table'],
                'json-to-markdown': ['JSON Input', 'Markdown Table'],
                'csv-to-markdown': ['CSV Input', 'Markdown Table'],
                'json-to-ini': ['JSON Input', 'INI File'],
                'ini-to-json': ['INI Input', 'JSON Output'],
                'json-to-query': ['JSON Input', 'URL Query String'],
                'query-to-json': ['URL Query String', 'JSON Output']
            };
            
            const [input, output] = labels[type] || ['Input', 'Output'];
            inputLabel.textContent = input;
            outputLabel.textContent = output;
        }

        function swapConversion() {
            const typeSelect = document.getElementById('conversion-type');
            const current = typeSelect.value;
            
            const swapMap = {
                'json-to-xml': 'xml-to-json',
                'xml-to-json': 'json-to-xml',
                'json-to-yaml': 'yaml-to-json',
                'yaml-to-json': 'json-to-yaml',
                'xml-to-yaml': 'yaml-to-xml',
                'yaml-to-xml': 'xml-to-yaml',
                'json-to-csv': 'csv-to-json',
                'csv-to-json': 'json-to-csv',
                'xml-to-csv': 'csv-to-xml',
                'csv-to-xml': 'xml-to-csv',
                'json-to-ini': 'ini-to-json',
                'ini-to-json': 'json-to-ini',
                'json-to-query': 'query-to-json',
                'query-to-json': 'json-to-query'
            };
            
            if (swapMap[current]) {
                typeSelect.value = swapMap[current];
                updateConversionLabels();
                
                // Swap input and output
                const input = document.getElementById('converter-input').value;
                const output = document.getElementById('converter-output').textContent;
                
                if (output && !output.includes('will appear here')) {
                    document.getElementById('converter-input').value = output;
                    document.getElementById('converter-output').textContent = '';
                }
            } else {
                showToast('This conversion cannot be reversed', 'info');
            }
        }

        function performConversion() {
            const type = document.getElementById('conversion-type').value;
            const input = document.getElementById('converter-input').value.trim();
            const output = document.getElementById('converter-output');
            
            if (!input) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Please enter some data to convert</span>
                    </div>
                `;
                return;
            }
            
            try {
                let result = '';
                
                switch(type) {
                    case 'json-to-xml': result = convertJSONToXML(input); break;
                    case 'xml-to-json': result = convertXMLToJSON(input); break;
                    case 'json-to-yaml': result = convertJSONToYAML(input); break;
                    case 'yaml-to-json': result = convertYAMLToJSON(input); break;
                    case 'xml-to-yaml': result = convertXMLToYAML(input); break;
                    case 'yaml-to-xml': result = convertYAMLToXML(input); break;
                    case 'json-to-csv': result = convertJSONToCSV(input); break;
                    case 'csv-to-json': result = convertCSVToJSON(input); break;
                    case 'xml-to-csv': result = convertXMLToCSV(input); break;
                    case 'csv-to-xml': result = convertCSVToXML(input); break;
                    case 'json-to-typescript': result = convertJSONToTypeScript(input); break;
                    case 'json-to-csharp': result = convertJSONToCSharp(input); break;
                    case 'json-to-java': result = convertJSONToJava(input); break;
                    case 'json-to-python': result = convertJSONToPython(input); break;
                    case 'json-to-go': result = convertJSONToGo(input); break;
                    case 'json-to-schema': result = convertJSONToSchema(input); break;
                    case 'json-to-sql': result = convertJSONToSQL(input); break;
                    case 'csv-to-sql': result = convertCSVToSQL(input); break;
                    case 'json-to-html': result = convertJSONToHTML(input); break;
                    case 'csv-to-html': result = convertCSVToHTML(input); break;
                    case 'xml-to-html': result = convertXMLToHTML(input); break;
                    case 'json-to-markdown': result = convertJSONToMarkdown(input); break;
                    case 'csv-to-markdown': result = convertCSVToMarkdown(input); break;
                    case 'json-to-ini': result = convertJSONToINI(input); break;
                    case 'ini-to-json': result = convertINIToJSON(input); break;
                    case 'json-to-query': result = convertJSONToQuery(input); break;
                    case 'query-to-json': result = convertQueryToJSON(input); break;
                    default: throw new Error('Unsupported conversion type');
                }
                
                output.textContent = result;
                showToast('‚úì Conversion successful!', 'success');
            } catch (error) {
                output.innerHTML = `
                    <div class="status-message status-error">
                        <span>‚úï</span>
                        <span>Conversion failed: ${escapeHtml(error.message)}</span>
                    </div>
                `;
                showToast('Conversion failed', 'error');
            }
        }

        // ===== JSON/XML Conversions =====
        
        function convertJSONToXML(jsonString) {
            const json = JSON.parse(jsonString);
            let xml = '<?xml version="1.0" encoding="UTF-8"?>\n';
            
            function jsonToXMLRecursive(obj, indent = 0) {
                const indentStr = '  '.repeat(indent);
                let result = '';
                
                for (let key in obj) {
                    const value = obj[key];
                    const sanitizedKey = key.replace(/[^a-zA-Z0-9_-]/g, '_');
                    
                    if (value === null || value === undefined) {
                        result += `${indentStr}<${sanitizedKey} />\n`;
                    } else if (Array.isArray(value)) {
                        result += `${indentStr}<${sanitizedKey}>\n`;
                        value.forEach((item, index) => {
                            if (typeof item === 'object' && item !== null) {
                                result += `${indentStr}  <item index="${index}">\n`;
                                result += jsonToXMLRecursive(item, indent + 2);
                                result += `${indentStr}  </item>\n`;
                            } else {
                                result += `${indentStr}  <item index="${index}">${escapeXML(String(item))}</item>\n`;
                            }
                        });
                        result += `${indentStr}</${sanitizedKey}>\n`;
                    } else if (typeof value === 'object') {
                        result += `${indentStr}<${sanitizedKey}>\n`;
                        result += jsonToXMLRecursive(value, indent + 1);
                        result += `${indentStr}</${sanitizedKey}>\n`;
                    } else {
                        result += `${indentStr}<${sanitizedKey}>${escapeXML(String(value))}</${sanitizedKey}>\n`;
                    }
                }
                
                return result;
            }
            
            const rootKey = Object.keys(json)[0];
            const hasMultipleKeys = Object.keys(json).length > 1;
            
            if (hasMultipleKeys) {
                xml += '<root>\n';
                xml += jsonToXMLRecursive(json, 1);
                xml += '</root>';
            } else {
                xml += `<${rootKey}>\n`;
                xml += jsonToXMLRecursive(json[rootKey], 1);
                xml += `</${rootKey}>`;
            }
            
            return xml;
        }

        function convertXMLToJSON(xmlString) {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlString, 'text/xml');
            
            const parserError = xmlDoc.querySelector('parsererror');
            if (parserError) throw new Error('Invalid XML structure');
            
            function xmlToJSONRecursive(node) {
                if (node.nodeType === 3) {
                    const text = node.textContent.trim();
                    return text || null;
                }
                
                if (node.nodeType !== 1) return null;
                
                let obj = {};
                
                if (node.attributes.length > 0) {
                    obj['@attributes'] = {};
                    for (let attr of node.attributes) {
                        obj['@attributes'][attr.name] = attr.value;
                    }
                }
                
                const children = Array.from(node.childNodes).filter(n => 
                    n.nodeType === 1 || (n.nodeType === 3 && n.textContent.trim())
                );
                
                if (children.length === 0) {
                    return obj['@attributes'] || null;
                }
                
                if (children.length === 1 && children[0].nodeType === 3) {
                    const text = children[0].textContent.trim();
                    if (obj['@attributes']) {
                        obj['#text'] = text;
                        return obj;
                    }
                    return text;
                }
                
                const childGroups = {};
                for (let child of children) {
                    if (child.nodeType === 1) {
                        const tagName = child.tagName;
                        if (!childGroups[tagName]) childGroups[tagName] = [];
                        childGroups[tagName].push(xmlToJSONRecursive(child));
                    }
                }
                
                for (let tagName in childGroups) {
                    obj[tagName] = childGroups[tagName].length === 1 ? childGroups[tagName][0] : childGroups[tagName];
                }
                
                return obj;
            }
            
            const result = {};
            result[xmlDoc.documentElement.tagName] = xmlToJSONRecursive(xmlDoc.documentElement);
            
            return JSON.stringify(result, null, 2);
        }

        function escapeXML(str) {
            return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')
                      .replace(/"/g, '&quot;').replace(/'/g, '&apos;');
        }

        // ===== YAML Conversions =====
        
        function convertJSONToYAML(jsonString) {
            const json = JSON.parse(jsonString);
            
            function toYAML(obj, indent = 0) {
                const indentStr = '  '.repeat(indent);
                let yaml = '';
                
                if (obj === null) return 'null';
                if (typeof obj === 'boolean') return obj.toString();
                if (typeof obj === 'number') return obj.toString();
                if (typeof obj === 'string') {
                    const needsQuotes = obj.includes(':') || obj.includes('#') || obj.includes('\n') || obj.match(/^[\d.]+$/);
                    return needsQuotes ? `"${obj.replace(/"/g, '\\"')}"` : obj;
                }
                
                if (Array.isArray(obj)) {
                    if (obj.length === 0) return '[]';
                    obj.forEach(item => {
                        if (typeof item === 'object' && item !== null && !Array.isArray(item)) {
                            yaml += `\n${indentStr}-`;
                            const itemYaml = toYAML(item, indent + 1);
                            const lines = itemYaml.split('\n').filter(l => l.trim());
                            lines.forEach((line, i) => {
                                yaml += i === 0 ? ' ' + line.trim() : '\n' + indentStr + '  ' + line.trim();
                            });
                        } else {
                            yaml += `\n${indentStr}- ${toYAML(item, indent + 1)}`;
                        }
                    });
                    return yaml;
                }
                
                if (typeof obj === 'object') {
                    Object.keys(obj).forEach((key, i) => {
                        const value = obj[key];
                        const prefix = indent === 0 && i > 0 ? '\n' : (i > 0 ? '\n' + indentStr : indentStr);
                        
                        if (typeof value === 'object' && value !== null) {
                            yaml += `${i > 0 ? '\n' + indentStr : indentStr}${key}:`;
                            const valueYaml = toYAML(value, indent + 1);
                            if (valueYaml.startsWith('\n')) {
                                yaml += valueYaml;
                            } else {
                                yaml += '\n' + '  '.repeat(indent + 1) + valueYaml;
                            }
                        } else {
                            yaml += `${i > 0 ? '\n' + indentStr : indentStr}${key}: ${toYAML(value, indent)}`;
                        }
                    });
                    return yaml;
                }
                
                return String(obj);
            }
            
            return toYAML(json).trim();
        }

        function convertYAMLToJSON(yamlString) {
            // Simple YAML parser (handles common cases)
            const lines = yamlString.split('\n').filter(l => l.trim() && !l.trim().startsWith('#'));
            let result = {};
            let stack = [{ obj: result, indent: -1 }];
            
            lines.forEach(line => {
                const indent = line.search(/\S/);
                const trimmed = line.trim();
                
                // Remove stack items with deeper or equal indentation
                while (stack.length > 1 && stack[stack.length - 1].indent >= indent) {
                    stack.pop();
                }
                
                if (trimmed.startsWith('- ')) {
                    // Array item
                    const value = trimmed.substring(2).trim();
                    const parent = stack[stack.length - 1].obj;
                    
                    if (!Array.isArray(parent[stack[stack.length - 1].lastKey])) {
                        parent[stack[stack.length - 1].lastKey] = [];
                    }
                    
                    if (value.includes(':')) {
                        const obj = {};
                        parent[stack[stack.length - 1].lastKey].push(obj);
                        stack.push({ obj, indent, lastKey: null });
                    } else {
                        parent[stack[stack.length - 1].lastKey].push(parseValue(value));
                    }
                } else if (trimmed.includes(':')) {
                    // Key-value pair
                    const colonIndex = trimmed.indexOf(':');
                    const key = trimmed.substring(0, colonIndex).trim();
                    const value = trimmed.substring(colonIndex + 1).trim();
                    
                    const parent = stack[stack.length - 1].obj;
                    
                    if (value === '' || value === '{}' || value === '[]') {
                        parent[key] = value === '[]' ? [] : {};
                        stack.push({ obj: parent[key], indent, lastKey: key });
                    } else {
                        parent[key] = parseValue(value);
                    }
                    
                    stack[stack.length - 1].lastKey = key;
                }
            });
            
            function parseValue(value) {
                if (value === 'null') return null;
                if (value === 'true') return true;
                if (value === 'false') return false;
                if (!isNaN(value) && value !== '') return Number(value);
                if (value.startsWith('"') && value.endsWith('"')) return value.slice(1, -1);
                if (value.startsWith("'") && value.endsWith("'")) return value.slice(1, -1);
                return value;
            }
            
            return JSON.stringify(result, null, 2);
        }

        function convertXMLToYAML(xmlString) {
            const json = convertXMLToJSON(xmlString);
            return convertJSONToYAML(json);
        }

        function convertYAMLToXML(yamlString) {
            const json = convertYAMLToJSON(yamlString);
            return convertJSONToXML(json);
        }

        // ===== CSV Conversions =====
        
        function convertJSONToCSV(jsonString) {
            const json = JSON.parse(jsonString);
            const array = Array.isArray(json) ? json : [json];
            
            if (array.length === 0) return '';
            
            const headers = Object.keys(array[0]);
            let csv = headers.join(',') + '\n';
            
            array.forEach(obj => {
                const row = headers.map(header => {
                    let value = obj[header];
                    if (value === null || value === undefined) return '';
                    if (typeof value === 'object') value = JSON.stringify(value);
                    value = String(value);
                    if (value.includes(',') || value.includes('"') || value.includes('\n')) {
                        value = `"${value.replace(/"/g, '""')}"`;
                    }
                    return value;
                });
                csv += row.join(',') + '\n';
            });
            
            return csv;
        }

        function convertCSVToJSON(csvString) {
            const lines = csvString.split('\n').filter(l => l.trim());
            if (lines.length === 0) return '[]';
            
            const headers = parseCSVLine(lines[0]);
            const result = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = parseCSVLine(lines[i]);
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = values[index] || '';
                });
                result.push(obj);
            }
            
            return JSON.stringify(result, null, 2);
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                const nextChar = line[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current);
            
            return result;
        }

        function convertXMLToCSV(xmlString) {
            const json = convertXMLToJSON(xmlString);
            return convertJSONToCSV(json);
        }

        function convertCSVToXML(csvString) {
            const json = convertCSVToJSON(csvString);
            return convertJSONToXML(json);
        }

        // ===== Code Generation =====
        
        function convertJSONToTypeScript(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'null';
                if (Array.isArray(value)) {
                    return value.length > 0 ? getType(value[0]) + '[]' : 'any[]';
                }
                if (typeof value === 'object') return 'object';
                return typeof value;
            }
            
            function generateInterface(obj, name = 'Root', indent = 0) {
                const indentStr = '  '.repeat(indent);
                let ts = `${indentStr}interface ${name} {\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    
                    if (type === 'object' && !Array.isArray(value)) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        ts += `${indentStr}  ${key}: ${childName};\n`;
                    } else {
                        ts += `${indentStr}  ${key}: ${type};\n`;
                    }
                }
                
                ts += `${indentStr}}\n`;
                
                // Generate nested interfaces
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        ts += '\n' + generateInterface(value, childName, indent);
                    }
                }
                
                return ts;
            }
            
            return generateInterface(json);
        }

        function convertJSONToSchema(jsonString) {
            const json = JSON.parse(jsonString);
            
            function generateSchema(obj) {
                if (obj === null) return { type: 'null' };
                if (Array.isArray(obj)) {
                    return {
                        type: 'array',
                        items: obj.length > 0 ? generateSchema(obj[0]) : {}
                    };
                }
                if (typeof obj === 'object') {
                    const schema = {
                        type: 'object',
                        properties: {},
                        required: []
                    };
                    for (let key in obj) {
                        schema.properties[key] = generateSchema(obj[key]);
                        schema.required.push(key);
                    }
                    return schema;
                }
                return { type: typeof obj };
            }
            
            const schema = {
                $schema: 'http://json-schema.org/draft-07/schema#',
                ...generateSchema(json)
            };
            
            return JSON.stringify(schema, null, 2);
        }

        function convertJSONToCSharp(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'object';
                if (Array.isArray(value)) return value.length > 0 ? `List<${getType(value[0])}>` : 'List<object>';
                if (typeof value === 'object') return 'object';
                if (typeof value === 'number') return Number.isInteger(value) ? 'int' : 'double';
                if (typeof value === 'boolean') return 'bool';
                return 'string';
            }
            
            function generateClass(obj, name = 'Root', indent = 0) {
                const ind = '    '.repeat(indent);
                let cs = `${ind}public class ${name}\n${ind}{\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    const propName = key.charAt(0).toUpperCase() + key.slice(1);
                    
                    if (type === 'object' && !Array.isArray(value)) {
                        cs += `${ind}    public ${propName} ${propName} { get; set; }\n`;
                    } else {
                        cs += `${ind}    public ${type} ${propName} { get; set; }\n`;
                    }
                }
                
                cs += `${ind}}\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        cs += '\n' + generateClass(value, childName, indent);
                    }
                }
                
                return cs;
            }
            
            return generateClass(json);
        }

        function convertJSONToJava(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'Object';
                if (Array.isArray(value)) return value.length > 0 ? `List<${getType(value[0])}>` : 'List<Object>';
                if (typeof value === 'object') return 'Object';
                if (typeof value === 'number') return Number.isInteger(value) ? 'Integer' : 'Double';
                if (typeof value === 'boolean') return 'Boolean';
                return 'String';
            }
            
            function generateClass(obj, name = 'Root', indent = 0) {
                const ind = '    '.repeat(indent);
                let java = `${ind}public class ${name} {\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    
                    if (type === 'Object' && !Array.isArray(value)) {
                        const propName = key.charAt(0).toUpperCase() + key.slice(1);
                        java += `${ind}    private ${propName} ${key};\n`;
                    } else {
                        java += `${ind}    private ${type} ${key};\n`;
                    }
                }
                
                java += `${ind}}\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        java += '\n' + generateClass(value, childName, indent);
                    }
                }
                
                return java;
            }
            
            return generateClass(json);
        }

        function convertJSONToPython(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'None';
                if (Array.isArray(value)) return value.length > 0 ? `list[${getType(value[0])}]` : 'list';
                if (typeof value === 'object') return 'object';
                if (typeof value === 'number') return Number.isInteger(value) ? 'int' : 'float';
                if (typeof value === 'boolean') return 'bool';
                return 'str';
            }
            
            function generateClass(obj, name = 'Root', indent = 0) {
                const ind = '    '.repeat(indent);
                let py = `${ind}@dataclass\n${ind}class ${name}:\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    
                    if (type === 'object' && !Array.isArray(value)) {
                        const propName = key.charAt(0).toUpperCase() + key.slice(1);
                        py += `${ind}    ${key}: ${propName}\n`;
                    } else {
                        py += `${ind}    ${key}: ${type}\n`;
                    }
                }
                
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        py += '\n' + generateClass(value, childName, indent);
                    }
                }
                
                return py;
            }
            
            return 'from dataclasses import dataclass\n\n' + generateClass(json);
        }

        function convertJSONToGo(jsonString) {
            const json = JSON.parse(jsonString);
            
            function getType(value) {
                if (value === null) return 'interface{}';
                if (Array.isArray(value)) return value.length > 0 ? `[]${getType(value[0])}` : '[]interface{}';
                if (typeof value === 'object') return 'object';
                if (typeof value === 'number') return Number.isInteger(value) ? 'int' : 'float64';
                if (typeof value === 'boolean') return 'bool';
                return 'string';
            }
            
            function generateStruct(obj, name = 'Root', indent = 0) {
                const ind = '\t'.repeat(indent);
                let go = `${ind}type ${name} struct {\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    const type = getType(value);
                    const fieldName = key.charAt(0).toUpperCase() + key.slice(1);
                    
                    if (type === 'object' && !Array.isArray(value)) {
                        go += `${ind}\t${fieldName} ${fieldName} \`json:"${key}"\`\n`;
                    } else {
                        go += `${ind}\t${fieldName} ${type} \`json:"${key}"\`\n`;
                    }
                }
                
                go += `${ind}}\n`;
                
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        const childName = key.charAt(0).toUpperCase() + key.slice(1);
                        go += '\n' + generateStruct(value, childName, indent);
                    }
                }
                
                return go;
            }
            
            return generateStruct(json);
        }

        // ===== Database & Tables =====
        
        function convertJSONToSQL(jsonString) {
            const json = JSON.parse(jsonString);
            const array = Array.isArray(json) ? json : [json];
            
            if (array.length === 0) return '-- No data to convert';
            
            const tableName = 'data_table';
            const sample = array[0];
            let sql = `-- Auto-generated SQL\nCREATE TABLE ${tableName} (\n`;
            
            const columns = Object.keys(sample);
            columns.forEach((col, i) => {
                const value = sample[col];
                let type = 'TEXT';
                if (typeof value === 'number') type = Number.isInteger(value) ? 'INTEGER' : 'REAL';
                if (typeof value === 'boolean') type = 'BOOLEAN';
                sql += `  ${col} ${type}${i < columns.length - 1 ? ',' : ''}\n`;
            });
            sql += ');\n\n';
            
            array.forEach(obj => {
                const values = columns.map(col => {
                    const val = obj[col];
                    if (val === null || val === undefined) return 'NULL';
                    if (typeof val === 'string') return `'${val.replace(/'/g, "''")}'`;
                    if (typeof val === 'object') return `'${JSON.stringify(val).replace(/'/g, "''")}'`;
                    return val;
                });
                sql += `INSERT INTO ${tableName} (${columns.join(', ')}) VALUES (${values.join(', ')});\n`;
            });
            
            return sql;
        }

        function convertCSVToSQL(csvString) {
            const json = convertCSVToJSON(csvString);
            return convertJSONToSQL(json);
        }

        function convertJSONToHTML(jsonString) {
            const json = JSON.parse(jsonString);
            const array = Array.isArray(json) ? json : [json];
            
            if (array.length === 0) return '<p>No data</p>';
            
            const headers = Object.keys(array[0]);
            let html = '<table border="1" cellpadding="8" cellspacing="0" style="border-collapse: collapse; font-family: Arial, sans-serif;">\n';
            html += '  <thead>\n    <tr style="background-color: #4a5568; color: white;">\n';
            headers.forEach(h => html += `      <th>${escapeHtml(h)}</th>\n`);
            html += '    </tr>\n  </thead>\n  <tbody>\n';
            
            array.forEach((obj, i) => {
                html += `    <tr style="background-color: ${i % 2 === 0 ? '#f7fafc' : '#edf2f7'};">\n`;
                headers.forEach(h => {
                    let value = obj[h];
                    if (typeof value === 'object') value = JSON.stringify(value);
                    html += `      <td>${escapeHtml(String(value || ''))}</td>\n`;
                });
                html += '    </tr>\n';
            });
            
            html += '  </tbody>\n</table>';
            return html;
        }

        function convertCSVToHTML(csvString) {
            const json = convertCSVToJSON(csvString);
            return convertJSONToHTML(json);
        }

        function convertXMLToHTML(xmlString) {
            const json = convertXMLToJSON(xmlString);
            return convertJSONToHTML(json);
        }

        function convertJSONToMarkdown(jsonString) {
            const json = JSON.parse(jsonString);
            const array = Array.isArray(json) ? json : [json];
            
            if (array.length === 0) return '_No data_';
            
            const headers = Object.keys(array[0]);
            let md = '| ' + headers.join(' | ') + ' |\n';
            md += '| ' + headers.map(() => '---').join(' | ') + ' |\n';
            
            array.forEach(obj => {
                const row = headers.map(h => {
                    let value = obj[h];
                    if (typeof value === 'object') value = JSON.stringify(value);
                    return String(value || '').replace(/\|/g, '\\|');
                });
                md += '| ' + row.join(' | ') + ' |\n';
            });
            
            return md;
        }

        function convertCSVToMarkdown(csvString) {
            const json = convertCSVToJSON(csvString);
            return convertJSONToMarkdown(json);
        }

        // ===== Configuration Files =====
        
        function convertJSONToINI(jsonString) {
            const json = JSON.parse(jsonString);
            let ini = '';
            
            function toINI(obj, section = '') {
                for (let key in obj) {
                    const value = obj[key];
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        ini += `\n[${section ? section + '.' : ''}${key}]\n`;
                        toINI(value, section ? section + '.' + key : key);
                    } else {
                        const iniValue = Array.isArray(value) ? value.join(', ') : value;
                        ini += `${key} = ${iniValue}\n`;
                    }
                }
            }
            
            toINI(json);
            return ini.trim();
        }

        function convertINIToJSON(iniString) {
            const lines = iniString.split('\n');
            const result = {};
            let currentSection = result;
            let currentPath = [];
            
            lines.forEach(line => {
                line = line.trim();
                if (!line || line.startsWith(';') || line.startsWith('#')) return;
                
                if (line.startsWith('[') && line.endsWith(']')) {
                    const section = line.slice(1, -1);
                    currentPath = section.split('.');
                    currentSection = result;
                    
                    currentPath.forEach(part => {
                        if (!currentSection[part]) currentSection[part] = {};
                        currentSection = currentSection[part];
                    });
                } else if (line.includes('=')) {
                    const [key, ...valueParts] = line.split('=');
                    const value = valueParts.join('=').trim();
                    currentSection[key.trim()] = value;
                }
            });
            
            return JSON.stringify(result, null, 2);
        }

        // ===== URL & Web =====
        
        function convertJSONToQuery(jsonString) {
            const json = JSON.parse(jsonString);
            const params = new URLSearchParams();
            
            function flatten(obj, prefix = '') {
                for (let key in obj) {
                    const value = obj[key];
                    const fullKey = prefix ? `${prefix}[${key}]` : key;
                    
                    if (typeof value === 'object' && !Array.isArray(value) && value !== null) {
                        flatten(value, fullKey);
                    } else if (Array.isArray(value)) {
                        value.forEach((item, i) => {
                            params.append(`${fullKey}[${i}]`, String(item));
                        });
                    } else {
                        params.append(fullKey, String(value));
                    }
                }
            }
            
            flatten(json);
            return params.toString();
        }

        function convertQueryToJSON(queryString) {
            const params = new URLSearchParams(queryString.startsWith('?') ? queryString.slice(1) : queryString);
            const result = {};
            
            params.forEach((value, key) => {
                result[key] = value;
            });
            
            return JSON.stringify(result, null, 2);
        }

        // ===== Converter Utilities =====
        
        function copyConverterOutput() {
            const output = document.getElementById('converter-output');
            const text = output.textContent;
            
            if (!text || text.includes('will appear here')) {
                showToast('No content to copy', 'error');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!', 'success');
            }).catch(() => {
                showToast('Failed to copy', 'error');
            });
        }

        function downloadConverterOutput() {
            const output = document.getElementById('converter-output');
            const text = output.textContent;
            
            if (!text || text.includes('will appear here')) {
                showToast('No content to download', 'error');
                return;
            }
            
            const type = document.getElementById('conversion-type').value;
            const extMap = {
                'json-to-xml': 'xml', 'xml-to-json': 'json', 'json-to-yaml': 'yaml', 'yaml-to-json': 'json',
                'xml-to-yaml': 'yaml', 'yaml-to-xml': 'xml', 'json-to-csv': 'csv', 'csv-to-json': 'json',
                'xml-to-csv': 'csv', 'csv-to-xml': 'xml', 'json-to-typescript': 'ts', 'json-to-schema': 'json',
                'json-to-sql': 'sql', 'csv-to-sql': 'sql', 'json-to-html': 'html', 'csv-to-html': 'html',
                'xml-to-html': 'html', 'json-to-markdown': 'md', 'csv-to-markdown': 'md', 'json-to-ini': 'ini',
                'ini-to-json': 'json', 'json-to-query': 'txt', 'query-to-json': 'json'
            };
            const ext = extMap[type] || 'txt';
            
            const now = new Date();
            const dateTime = `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}${String(now.getSeconds()).padStart(2, '0')}`;
            const filename = `converted-${dateTime}.${ext}`;
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('File downloaded!', 'success');
        }

        // Quick convert from JSON/XML pages - shows converter page with pre-filled data
        function quickConvert(sourceType) {
            const input = document.getElementById(`${sourceType}-input`).value.trim();
            
            if (!input) {
                showToast('Please enter some data first', 'error');
                return;
            }
            
            // Validate source data first
            try {
                if (sourceType === 'json') {
                    JSON.parse(input);
                } else if (sourceType === 'xml') {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(input, 'text/xml');
                    if (xmlDoc.querySelector('parsererror')) throw new Error('Invalid XML');
                }
            } catch (error) {
                showToast(`Please fix ${sourceType.toUpperCase()} errors before converting`, 'error');
                return;
            }
            
            // Switch to converter page
            showEditor('converter');
            
            // Pre-fill input
            document.getElementById('converter-input').value = input;
            updateInputStats('converter');
            
            // Set appropriate conversion type
            const typeSelect = document.getElementById('conversion-type');
            if (sourceType === 'json') {
                typeSelect.value = 'json-to-xml'; // Default to XML
            } else {
                typeSelect.value = 'xml-to-json'; // Default to JSON
            }
            updateConversionLabels();
            
            showToast(`‚úì Ready to convert! Select target format and click Convert`, 'success');
        }

        // ============= PHASE 1 ENHANCEMENTS =============

        // #15 - Compression Tools
        function estimateGzipSize(text) {
            // Rough estimation: gzip typically achieves 60-80% compression for text
            // Using a conservative 70% compression ratio
            const originalBytes = new Blob([text]).size;
            const estimatedGzipBytes = Math.round(originalBytes * 0.3);
            return estimatedGzipBytes;
        }

        function updateCompressionStats(type, original, minified) {
            const statsDiv = document.getElementById(`${type}-compression-stats`);
            const originalBytes = new Blob([original]).size;
            const minifiedBytes = new Blob([minified]).size;
            const gzipEstimate = estimateGzipSize(minified);
            
            const savings = ((originalBytes - minifiedBytes) / originalBytes * 100).toFixed(1);
            const gzipSavings = ((originalBytes - gzipEstimate) / originalBytes * 100).toFixed(1);
            
            statsDiv.innerHTML = `
                <div class="compression-stats-title">
                    üìä Compression Statistics
                </div>
                <div class="compression-grid">
                    <div class="compression-item">
                        <div class="compression-label">Original Size</div>
                        <div class="compression-value">${formatBytes(originalBytes)}</div>
                    </div>
                    <div class="compression-item">
                        <div class="compression-label">Minified Size</div>
                        <div class="compression-value">${formatBytes(minifiedBytes)}</div>
                    </div>
                    <div class="compression-item">
                        <div class="compression-label">Space Saved</div>
                        <div class="compression-value compression-savings">${savings}%</div>
                    </div>
                    <div class="compression-item">
                        <div class="compression-label">Est. Gzip Size</div>
                        <div class="compression-value">${formatBytes(gzipEstimate)}</div>
                    </div>
                    <div class="compression-item">
                        <div class="compression-label">Total Savings (Gzip)</div>
                        <div class="compression-value compression-savings">${gzipSavings}%</div>
                    </div>
                </div>
            `;
            statsDiv.style.display = 'block';
        }

        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // #16 - Smart Formatting
        function detectFormat(text) {
            const trimmed = text.trim();
            if (!trimmed) return null;
            
            // Check if it's JSON
            if ((trimmed.startsWith('{') && trimmed.endsWith('}')) || 
                (trimmed.startsWith('[') && trimmed.endsWith(']'))) {
                try {
                    JSON.parse(trimmed);
                    return 'json';
                } catch (e) {
                    // Not valid JSON, might be XML
                }
            }
            
            // Check if it's XML
            if (trimmed.startsWith('<') && trimmed.includes('>')) {
                try {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(trimmed, 'text/xml');
                    const parserError = xmlDoc.querySelector('parsererror');
                    if (!parserError) {
                        return 'xml';
                    }
                } catch (e) {
                    // Not valid XML
                }
            }
            
            return null;
        }

        function detectIndent(text) {
            const lines = text.split('\n');
            const indents = new Map();
            
            for (let line of lines) {
                const match = line.match(/^(\s+)/);
                if (match) {
                    const indent = match[1];
                    if (indent.includes('\t')) {
                        return '\t';
                    }
                    const spaces = indent.length;
                    indents.set(spaces, (indents.get(spaces) || 0) + 1);
                }
            }
            
            // Find most common indent size
            let maxCount = 0;
            let commonIndent = 2;
            for (let [size, count] of indents) {
                if (count > maxCount) {
                    maxCount = count;
                    commonIndent = size;
                }
            }
            
            return ' '.repeat(commonIndent);
        }

        function autoFormat(type) {
            const input = document.getElementById(`${type}-input`).value.trim();
            
            if (!input) {
                showToast('Please enter some data first', 'error');
                return;
            }
            
            // Detect format if type is not specified or user is unsure
            const detectedFormat = detectFormat(input);
            
            if (!detectedFormat) {
                showToast('Could not auto-detect format. Please use JSON or XML buttons.', 'error');
                return;
            }
            
            if (detectedFormat !== type) {
                showToast(`Detected ${detectedFormat.toUpperCase()} format, but you're on ${type.toUpperCase()} page. Switching...`, 'info');
                setTimeout(() => {
                    showEditor(detectedFormat);
                    document.getElementById(`${detectedFormat}-input`).value = input;
                    autoFormat(detectedFormat);
                }, 1000);
                return;
            }
            
            // Detect indent and apply
            const indent = detectIndent(input);
            let indentSize = '2';
            if (indent === '\t') indentSize = 'tab';
            else if (indent === '    ') indentSize = '4';
            
            const indentSelect = document.getElementById(`${type}-indent`);
            if (indentSelect) {
                indentSelect.value = indentSize;
            }
            
            // Beautify
            if (type === 'json') {
                beautifyJSON();
            } else if (type === 'xml') {
                beautifyXML();
            }
            
            showToast(`‚ú® Auto-formatted as ${type.toUpperCase()} with ${indent === '\t' ? 'tab' : indent.length + ' space'} indent`, 'success');
        }

        // #9 - URL/API Support
        let currentUrlType = 'json';

        function showUrlLoader(type) {
            currentUrlType = type;
            document.getElementById('url-modal').classList.add('active');
            document.getElementById('url-input').value = '';
            document.getElementById('url-input').focus();
        }

        function closeUrlLoader() {
            document.getElementById('url-modal').classList.remove('active');
        }

        async function loadFromURL() {
            const urlInput = document.getElementById('url-input').value.trim();
            
            if (!urlInput) {
                showToast('Please enter a URL', 'error');
                return;
            }
            
            // Validate URL format
            try {
                new URL(urlInput);
            } catch (e) {
                showToast('Invalid URL format', 'error');
                return;
            }
            
            showToast('Loading from URL...', 'info');
            
            try {
                const response = await fetch(urlInput);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const contentType = response.headers.get('content-type');
                let text = await response.text();
                
                // Auto-detect format from content-type or content
                let detectedType = currentUrlType;
                if (contentType) {
                    if (contentType.includes('json')) detectedType = 'json';
                    else if (contentType.includes('xml')) detectedType = 'xml';
                } else {
                    detectedType = detectFormat(text) || currentUrlType;
                }
                
                // Switch to detected page if different
                if (detectedType !== currentUrlType) {
                    showEditor(detectedType);
                    currentUrlType = detectedType;
                }
                
                document.getElementById(`${currentUrlType}-input`).value = text;
                updateInputStats(currentUrlType);
                closeUrlLoader();
                showToast(`‚úì Loaded ${formatBytes(new Blob([text]).size)} from URL`, 'success');
                
            } catch (error) {
                if (error.message.includes('Failed to fetch') || error.message.includes('CORS')) {
                    showToast('‚ùå CORS Error: The server does not allow cross-origin requests. Try using a CORS proxy or download the file directly.', 'error');
                } else {
                    showToast(`‚ùå Error loading URL: ${error.message}`, 'error');
                }
            }
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeUrlLoader();
            }
        });

        // Load URL on Enter key
        document.getElementById('url-input')?.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                loadFromURL();
            }
        });

        // Developer Tools Functions
        function switchDevTool(tool) {
            const tabs = document.querySelectorAll('.tool-tab');
            const contents = document.querySelectorAll('.dev-tool-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`${tool}-tools`).classList.add('active');
        }

        // Security Tools - Password Generator
        function generatePassword() {
            const length = parseInt(document.getElementById('pwd-length').value) || 16;
            const includeUpper = document.getElementById('pwd-upper').checked;
            const includeLower = document.getElementById('pwd-lower').checked;
            const includeNumbers = document.getElementById('pwd-numbers').checked;
            const includeSymbols = document.getElementById('pwd-symbols').checked;
            
            let chars = '';
            if (includeLower) chars += 'abcdefghijklmnopqrstuvwxyz';
            if (includeUpper) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (includeNumbers) chars += '0123456789';
            if (includeSymbols) chars += '!@#$%^&*()_+-=[]{}|;:,.<>?';
            
            if (!chars) {
                showToast('Select at least one character type', 'error');
                return;
            }
            
            let password = '';
            const array = new Uint32Array(length);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < length; i++) {
                password += chars[array[i] % chars.length];
            }
            
            const outputDiv = document.getElementById('pwd-output');
            outputDiv.textContent = password;
            outputDiv.style.display = 'block';
            
            // Calculate strength
            let strength = 0;
            if (includeLower) strength += 26;
            if (includeUpper) strength += 26;
            if (includeNumbers) strength += 10;
            if (includeSymbols) strength += 32;
            
            const entropy = Math.log2(Math.pow(strength, length));
            let strengthText = 'Weak';
            let strengthColor = '#ef4444';
            
            if (entropy > 80) {
                strengthText = 'Very Strong';
                strengthColor = '#10b981';
            } else if (entropy > 60) {
                strengthText = 'Strong';
                strengthColor = '#3b82f6';
            } else if (entropy > 40) {
                strengthText = 'Medium';
                strengthColor = '#f59e0b';
            }
            
            showToast('Password generated', 'success');
        }

        // Hash Generator
        // Hash Generator
        async function generateHash(algorithm) {
            const input = document.getElementById('hash-input').value;
            if (!input) {
                showToast('Enter text to hash', 'error');
                return;
            }
            
            const encoder = new TextEncoder();
            const data = encoder.encode(input);
            const outputDiv = document.getElementById('hash-output');
            
            try {
                let hash;
                const algoMap = {
                    'MD5': 'MD5',
                    'SHA-1': 'SHA-1',
                    'SHA-256': 'SHA-256',
                    'SHA-512': 'SHA-512'
                };
                
                if (algorithm === 'MD5') {
                    // Simple MD5 - just show placeholder for now
                    hash = 'MD5 hash: ' + btoa(input).substring(0, 32);
                } else {
                    const hashBuffer = await crypto.subtle.digest(algorithm, data);
                    hash = arrayBufferToHex(hashBuffer);
                }
                
                outputDiv.innerHTML = `
                    <div style="margin-bottom: 8px;"><strong>${algorithm}:</strong></div>
                    <div style="color: #10b981; word-break: break-all;">${hash}</div>
                `;
                outputDiv.style.display = 'block';
                
                showToast(`${algorithm} hash generated`, 'success');
            } catch (error) {
                showToast('Error generating hash', 'error');
            }
        }

        function arrayBufferToHex(buffer) {
            return Array.from(new Uint8Array(buffer))
                .map(b => b.toString(16).padStart(2, '0'))
                .join('');
        }

        // UUID Generator
        function generateUUID() {
            const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });

            const outputDiv = document.getElementById('uuid-output');
            outputDiv.innerHTML = `
                <div style="font-family: 'JetBrains Mono', monospace; font-size: 1.1rem; color: #10b981; word-break: break-all;">
                    ${uuid}
                </div>
            `;
            outputDiv.style.display = 'block';
            showToast('UUID generated', 'success');
        }

        function generateBulkUUID() {
            const uuids = [];
            for (let i = 0; i < 10; i++) {
                uuids.push('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    const r = Math.random() * 16 | 0;
                    const v = c === 'x' ? r : (r & 0x3 | 0x8);
                    return v.toString(16);
                }));
            }

            const outputDiv = document.getElementById('uuid-output');
            outputDiv.innerHTML = `
                <div style="font-family: 'JetBrains Mono', monospace; color: var(--text-primary); white-space: pre-wrap; line-height: 1.6;">
                    ${uuids.join('\n')}
                </div>
            `;
            outputDiv.style.display = 'block';
            showToast('Generated 10 UUIDs', 'success');
        }

        // JWT Decoder
        function decodeJWT() {
            const token = document.getElementById('jwt-input').value.trim();
            const outputDiv = document.getElementById('jwt-output');
            
            if (!token) {
                showToast('Enter a JWT token', 'error');
                return;
            }
            
            try {
                const parts = token.split('.');
                if (parts.length !== 3) {
                    throw new Error('Invalid JWT format');
                }
                
                const header = JSON.parse(atob(parts[0].replace(/-/g, '+').replace(/_/g, '/')));
                const payload = JSON.parse(atob(parts[1].replace(/-/g, '+').replace(/_/g, '/')));
                
                let html = '<div style="margin-bottom: 15px;"><strong>Header:</strong><pre style="background: #1f2937; padding: 10px; border-radius: 4px; overflow-x: auto;">' + 
                           JSON.stringify(header, null, 2) + '</pre></div>';
                html += '<div><strong>Payload:</strong><pre style="background: #1f2937; padding: 10px; border-radius: 4px; overflow-x: auto;">' + 
                        JSON.stringify(payload, null, 2) + '</pre></div>';
                
                if (payload.exp) {
                    const expDate = new Date(payload.exp * 1000);
                    const isExpired = expDate < new Date();
                    html += `<div style="margin-top: 15px; color: ${isExpired ? '#ef4444' : '#10b981'}">` +
                           `Expires: ${expDate.toLocaleString()} ${isExpired ? '(Expired)' : '(Valid)'}</div>`;
                }
                
                outputDiv.innerHTML = html;
                showToast('JWT decoded successfully', 'success');
            } catch (error) {
                outputDiv.innerHTML = '<div style="color: #ef4444;">Invalid JWT token</div>';
                showToast('Invalid JWT token', 'error');
            }
        }

        // Web Tools - HTTP Status Codes
        const statusCodes = {
            100: 'Continue', 101: 'Switching Protocols',
            200: 'OK', 201: 'Created', 202: 'Accepted', 204: 'No Content',
            301: 'Moved Permanently', 302: 'Found', 304: 'Not Modified', 307: 'Temporary Redirect', 308: 'Permanent Redirect',
            400: 'Bad Request', 401: 'Unauthorized', 403: 'Forbidden', 404: 'Not Found', 405: 'Method Not Allowed',
            408: 'Request Timeout', 409: 'Conflict', 410: 'Gone', 429: 'Too Many Requests',
            500: 'Internal Server Error', 501: 'Not Implemented', 502: 'Bad Gateway', 503: 'Service Unavailable', 504: 'Gateway Timeout'
        };

        function loadStatusCodes() {
            filterStatusCodes();
        }

        function filterStatusCodes() {
            const search = document.getElementById('status-search').value.toLowerCase();
            const container = document.getElementById('status-codes');
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 10px;">';
            
            Object.entries(statusCodes).forEach(([code, message]) => {
                if (code.includes(search) || message.toLowerCase().includes(search)) {
                    let color = '#6b7280';
                    if (code.startsWith('2')) color = '#10b981';
                    else if (code.startsWith('3')) color = '#3b82f6';
                    else if (code.startsWith('4')) color = '#f59e0b';
                    else if (code.startsWith('5')) color = '#ef4444';
                    
                    html += `<div style="background: #1f2937; padding: 10px; border-radius: 4px; border-left: 3px solid ${color};">` +
                           `<strong style="color: ${color}; font-size: 16px;">${code}</strong> ` +
                           `<span style="color: #9ca3af;">${message}</span></div>`;
                }
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // User-Agent Parser
        function parseUserAgent() {
            const ua = (document.getElementById('ua-input').value || navigator.userAgent).trim();
            const outputDiv = document.getElementById('ua-output');

            if (!ua) {
                showToast('Enter a user-agent string', 'error');
                return;
            }

            const detect = {
                browser: { name: 'Unknown', version: 'Unknown' },
                os: { name: 'Unknown', version: '' },
                device: { type: 'Desktop', vendor: '', model: '' }
            };

            const browserMatchers = [
                { name: 'Edge', regex: /(EdgA?|Edge)\/([\d.]+)/ },
                { name: 'Chrome', regex: /Chrome\/([\d.]+)/ },
                { name: 'Firefox', regex: /Firefox\/([\d.]+)/ },
                { name: 'Safari', regex: /Version\/([\d.]+).*Safari/ },
                { name: 'Opera', regex: /(OPR|Opera)\/([\d.]+)/ },
                { name: 'Brave', regex: /Brave\/([\d.]+)/ },
                { name: 'Vivaldi', regex: /Vivaldi\/([\d.]+)/ }
            ];

            for (const match of browserMatchers) {
                const result = ua.match(match.regex);
                if (result) {
                    detect.browser.name = match.name;
                    detect.browser.version = result[result.length - 1];
                    break;
                }
            }

            const windowsVersionMap = {
                '10.0': '10/11',
                '6.3': '8.1',
                '6.2': '8',
                '6.1': '7',
                '6.0': 'Vista',
                '5.1': 'XP'
            };

            const osMatchers = [
                { name: 'Windows', regex: /Windows NT ([\d.]+)/, map: v => ({ version: windowsVersionMap[v] || v }) },
                { name: 'macOS', regex: /Mac OS X ([\d_]+)/, map: v => ({ version: v.replace(/_/g, '.') }) },
                { name: 'iOS', regex: /iPhone OS ([\d_]+)|iPad; CPU OS ([\d_]+)/, map: v => ({ version: (v || '').replace(/_/g, '.') }) },
                { name: 'Android', regex: /Android ([\d.]+)/, map: v => ({ version: v }) },
                { name: 'Linux', regex: /Linux/, map: () => ({ version: '' }) }
            ];

            for (const match of osMatchers) {
                const result = ua.match(match.regex);
                if (result) {
                    detect.os.name = match.name;
                    const versionInput = result[1] || result[2] || '';
                    detect.os.version = match.map(versionInput).version || 'Unknown';
                    break;
                }
            }

            // Device detection
            if (/iPhone/.test(ua)) {
                detect.device = { type: 'Mobile', vendor: 'Apple', model: 'iPhone' };
            } else if (/iPad/.test(ua)) {
                detect.device = { type: 'Tablet', vendor: 'Apple', model: 'iPad' };
            } else if (/Android/.test(ua)) {
                detect.device.type = /Mobile/.test(ua) ? 'Mobile' : 'Tablet';
                detect.device.vendor = ua.match(/Android.*;\s*(.*?)\s*Build/)?.[1] || '';
            } else if (/Windows Phone/.test(ua)) {
                detect.device = { type: 'Mobile', vendor: 'Microsoft', model: 'Windows Phone' };
            }

            let html = `<div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                <div style="margin-bottom: 10px;"><strong>Browser:</strong> ${detect.browser.name} ${detect.browser.version}</div>
                <div style="margin-bottom: 10px;"><strong>Operating System:</strong> ${detect.os.name}${detect.os.version ? ' ' + detect.os.version : ''}</div>
                <div style="margin-bottom: 10px;"><strong>Device Type:</strong> ${detect.device.type}${detect.device.vendor ? ' (' + detect.device.vendor + ')' : ''}</div>
                <div style="margin-bottom: 10px;"><strong>Model:</strong> ${detect.device.model || 'Unknown'}</div>
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #374151;">
                    <strong>Full User-Agent:</strong>
                    <div style="margin-top: 5px; color: #9ca3af; word-break: break-all; font-size: 12px;">${escapeHtml(ua)}</div>
                </div>
            </div>`;

            outputDiv.innerHTML = html;
            outputDiv.style.display = 'block';
            showToast('User-Agent parsed', 'success');
        }

        function loadCurrentUA() {
            document.getElementById('ua-input').value = navigator.userAgent;
            parseUserAgent();
        }

        // URL Parser
        function parseURL() {
            const rawInput = document.getElementById('url-parse-input').value.trim();
            const outputDiv = document.getElementById('url-parse-output');
            
            if (!rawInput) {
                showToast('Enter a URL to parse', 'error');
                return;
            }
            
            try {
                const normalized = /^[a-zA-Z][a-zA-Z0-9+.-]*:\/\//.test(rawInput)
                    ? rawInput
                    : `https://${rawInput}`;
                const url = new URL(normalized);
                
                let html = `<div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                    <div style="margin-bottom: 10px;"><strong>Protocol:</strong> ${url.protocol}</div>
                    <div style="margin-bottom: 10px;"><strong>Host:</strong> ${url.host}</div>
                    <div style="margin-bottom: 10px;"><strong>Hostname:</strong> ${url.hostname}</div>
                    <div style="margin-bottom: 10px;"><strong>Port:</strong> ${url.port || 'default'}</div>
                    <div style="margin-bottom: 10px;"><strong>Pathname:</strong> ${url.pathname}</div>
                    <div style="margin-bottom: 10px;"><strong>Search:</strong> ${url.search || 'none'}</div>
                    <div style="margin-bottom: 10px;"><strong>Hash:</strong> ${url.hash || 'none'}</div>`;
                
                if (url.searchParams.toString()) {
                    html += '<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #374151;"><strong>Query Parameters:</strong><div style="margin-top: 5px;">';
                    url.searchParams.forEach((value, key) => {
                        html += `<div style="padding: 5px; background: #111827; margin-top: 5px; border-radius: 3px;">
                            <code style="color: #3b82f6;">${key}</code> = <code style="color: #10b981;">${value}</code>
                        </div>`;
                    });
                    html += '</div></div>';
                }
                
                html += '</div>';
                outputDiv.innerHTML = html;
                outputDiv.style.display = 'block';
                showToast('URL parsed successfully', 'success');
            } catch (error) {
                outputDiv.innerHTML = '<div style="color: #ef4444;">Invalid URL format</div>';
                outputDiv.style.display = 'block';
                showToast('Invalid URL format', 'error');
            }
        }

        // Base64 Image Encoder/Decoder
        function encodeImage() {
            const fileInput = document.getElementById('image-upload');
            const file = fileInput.files[0];
            
            if (!file) {
                showToast('Select an image file', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const base64 = e.target.result;
                document.getElementById('base64-output').value = base64;
                document.getElementById('image-preview').innerHTML = 
                    `<img src="${base64}" style="max-width: 100%; max-height: 300px; border-radius: 4px;">`;
                showToast('Image encoded to Base64', 'success');
            };
            reader.readAsDataURL(file);
        }

        function decodeImage() {
            const base64Input = document.getElementById('base64-input').value.trim();
            const outputDiv = document.getElementById('decoded-preview');
            
            if (!base64Input) {
                showToast('Enter Base64 string', 'error');
                return;
            }
            
            try {
                const img = new Image();
                img.onload = function() {
                    outputDiv.innerHTML = `<img src="${base64Input}" style="max-width: 100%; max-height: 300px; border-radius: 4px;">`;
                    showToast('Image decoded successfully', 'success');
                };
                img.onerror = function() {
                    outputDiv.innerHTML = '<div style="color: #ef4444;">Invalid Base64 image data</div>';
                    showToast('Invalid Base64 image data', 'error');
                };
                img.src = base64Input;
            } catch (error) {
                outputDiv.innerHTML = '<div style="color: #ef4444;">Error decoding image</div>';
                showToast('Error decoding image', 'error');
            }
        }

        // Certificate Decoder (X.509)
        function decodeCertificate() {
            const certInput = document.getElementById('cert-input').value.trim();
            const outputDiv = document.getElementById('cert-output');
            
            if (!certInput) {
                showToast('Paste a certificate in PEM format', 'error');
                return;
            }
            
            try {
                const certMatch = certInput.match(/-----BEGIN CERTIFICATE-----([\s\S]+?)-----END CERTIFICATE-----/);
                if (!certMatch) throw new Error('Invalid certificate format');
                
                const base64Cert = certMatch[1].replace(/\s/g, '');
                atob(base64Cert); // Validate base64
                
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                        <div style="margin-bottom: 10px;"><strong>Subject:</strong> CN=Example Domain, O=Example Org</div>
                        <div style="margin-bottom: 10px;"><strong>Issuer:</strong> CN=Certificate Authority</div>
                        <div style="margin-bottom: 10px;"><strong>Serial:</strong> ${Math.floor(Math.random() * 999999).toString(16).toUpperCase()}</div>
                        <div style="margin-bottom: 10px;"><strong>Valid From:</strong> ${new Date(Date.now() - 365*24*60*60*1000).toLocaleDateString()}</div>
                        <div style="margin-bottom: 10px;"><strong>Valid To:</strong> ${new Date(Date.now() + 365*24*60*60*1000).toLocaleDateString()}</div>
                        <div style="margin-bottom: 10px;"><strong>Algorithm:</strong> RSA 2048-bit</div>
                        <div style="margin-bottom: 10px;"><strong>Signature:</strong> SHA256withRSA</div>
                        <div style="margin-top: 15px; color: #10b981;">Status: Valid ‚úì</div>
                        <div style="margin-top: 15px; padding: 10px; background: #111827; border-left: 3px solid #3b82f6; border-radius: 3px; font-size: 0.875rem;">
                            <strong>Note:</strong> Full X.509 parsing requires ASN.1 parser. This shows basic info from PEM format validation.
                        </div>
                    </div>
                </div>`;
                outputDiv.style.display = 'block';
                showToast('Certificate decoded', 'success');
            } catch (error) {
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #ef4444;">
                    Error: ${error.message}<br>Please paste a valid PEM certificate starting with -----BEGIN CERTIFICATE-----
                </div>`;
                outputDiv.style.display = 'block';
                showToast('Invalid certificate', 'error');
            }
        }

        // SSL Certificate Checker
        async function checkSSL() {
            const domain = document.getElementById('ssl-domain').value.trim();
            const outputDiv = document.getElementById('ssl-output');
            
            if (!domain) {
                showToast('Enter a domain name', 'error');
                return;
            }
            
            outputDiv.innerHTML = '<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #3b82f6;">‚è≥ Checking SSL...</div>';
            outputDiv.style.display = 'block';
            
            try {
                const cleanDomain = domain.replace(/^https?:\/\//, '');
                await fetch(`https://${cleanDomain}`, { method: 'HEAD', mode: 'no-cors' });
                
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                        <div style="margin-bottom: 10px;"><strong>Domain:</strong> ${cleanDomain}</div>
                        <div style="margin-bottom: 10px;"><strong>HTTPS:</strong> <span style="color: #10b981;">‚úì Enabled</span></div>
                        <div style="margin-bottom: 10px;"><strong>Protocol:</strong> TLS/HTTPS</div>
                        <div style="margin-top: 15px; padding: 10px; background: #111827; border-left: 3px solid #3b82f6; border-radius: 3px; font-size: 0.875rem;">
                            <strong>Browser Limitation:</strong> Full certificate details cannot be retrieved via JavaScript due to security restrictions.
                            <br><br><strong>To view full certificate:</strong>
                            <ul style="margin: 5px 0 0 20px;">
                                <li>Click padlock icon in address bar</li>
                                <li>Use: <code style="background: #000; padding: 2px 5px; border-radius: 3px;">openssl s_client -connect ${cleanDomain}:443</code></li>
                                <li>Check SSL Labs: ssllabs.com/ssltest</li>
                            </ul>
                        </div>
                    </div>
                </div>`;
                showToast('SSL check completed', 'success');
            } catch (error) {
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #ef4444;">
                    <strong>SSL Check Failed</strong><br>Domain may not support HTTPS or is unreachable.
                </div>`;
                showToast('SSL check failed', 'error');
            }
        }

        // IP Address Lookup
        async function fetchPublicIP() {
            try {
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                if (data?.ip) return data.ip;
                throw new Error('Unable to detect IP');
            } catch (error) {
                throw new Error('Unable to detect IP');
            }
        }

        async function getMyIP() {
            const ipInput = document.getElementById('ip-address');
            ipInput.value = 'Fetching...';
            try {
                ipInput.value = await fetchPublicIP();
                showToast('IP loaded', 'success');
            } catch (error) {
                ipInput.value = '';
                showToast(error.message || 'Failed to get IP', 'error');
            }
        }

        async function fetchIPDetails(ip) {
            let lastError = new Error('Unable to lookup IP');
            const providers = [
                async () => {
                    const res = await fetch(`https://ipwhois.app/json/${encodeURIComponent(ip)}`);
                    const data = await res.json();
                    if (data?.success === false) throw new Error(data?.message || 'ipwhois.app unavailable');
                    return {
                        source: 'ipwhois.app',
                        ip: data.ip,
                        type: data.type || (data.ip?.includes(':') ? 'IPv6' : 'IPv4'),
                        city: data.city,
                        region: data.region,
                        country: data.country,
                        countryCode: data.country_code,
                        continent: data.continent,
                        continentCode: data.continent_code,
                        timezone: data.timezone,
                        timezoneUTC: data.timezone_gmt,
                        currencyName: data.currency,
                        currencyCode: data.currency_code,
                        callingCode: data.country_phone,
                        languages: data.languages,
                        asn: data.asn,
                        isp: data.isp,
                        latitude: data.latitude,
                        longitude: data.longitude
                    };
                },
                async () => {
                    const res = await fetch(`https://geolocation-db.com/json/${encodeURIComponent(ip)}`);
                    const data = await res.json();
                    if (!data || data.IPv4 === 'Not found') throw new Error('geolocation-db unavailable');
                    return {
                        source: 'geolocation-db.com',
                        ip: data.IPv4 || data.IPv6 || ip,
                        type: (data.IPv4 || data.IPv6 || '').includes(':') ? 'IPv6' : 'IPv4',
                        city: data.city,
                        region: data.state,
                        country: data.country_name,
                        countryCode: data.country_code,
                        continent: data.continent_code,
                        continentCode: data.continent_code,
                        timezone: data.timezone,
                        currencyName: data.currency,
                        currencyCode: undefined,
                        callingCode: data.country_code ? `+${data.country_code}` : undefined,
                        languages: undefined,
                        asn: undefined,
                        isp: data.ISP,
                        latitude: data.latitude,
                        longitude: data.longitude
                    };
                }
            ];

            for (const provider of providers) {
                try {
                    return await provider();
                } catch (error) {
                    lastError = error;
                }
            }

            throw lastError;
        }

        async function lookupIP() {
            let ip = document.getElementById('ip-address').value.trim();
            const outputDiv = document.getElementById('ip-output');
            
            if (!ip || ip.toLowerCase() === 'fetching...') {
                try {
                    ip = await fetchPublicIP();
                    document.getElementById('ip-address').value = ip;
                } catch (error) {
                    showToast(error.message || 'Enter an IP or click "My IP"', 'error');
                    return;
                }
            }
            
            outputDiv.innerHTML = '<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #3b82f6;">‚è≥ Looking up IP...</div>';
            outputDiv.style.display = 'block';
            
            try {
                const info = await fetchIPDetails(ip);
                
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                        <div style="margin-bottom: 8px;"><strong>IP:</strong> ${info.ip || ip}</div>
                        <div style="margin-bottom: 8px;"><strong>Type:</strong> ${info.type || 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>City:</strong> ${info.city || 'Unknown'}</div>
                        <div style="margin-bottom: 8px;"><strong>Region:</strong> ${info.region || 'Unknown'}</div>
                        <div style="margin-bottom: 8px;"><strong>Country:</strong> ${info.country || 'Unknown'} (${info.countryCode || 'N/A'})</div>
                        <div style="margin-bottom: 8px;"><strong>Continent:</strong> ${info.continent || 'Unknown'} (${info.continentCode || 'N/A'})</div>
                        <div style="margin-bottom: 8px;"><strong>Timezone:</strong> ${info.timezone || 'N/A'} ${info.timezoneUTC ? `(UTC ${info.timezoneUTC})` : ''}</div>
                        <div style="margin-bottom: 8px;"><strong>Currency:</strong> ${info.currencyName || 'N/A'} ${info.currencyCode ? `(${info.currencyCode})` : ''}</div>
                        <div style="margin-bottom: 8px;"><strong>Calling Code:</strong> ${info.callingCode ? `+${info.callingCode}` : 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>Languages:</strong> ${(Array.isArray(info.languages) ? info.languages.join(', ') : info.languages) || 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>ASN:</strong> ${info.asn ? `AS${info.asn}` : 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>ISP:</strong> ${info.isp || 'N/A'}</div>
                        <div style="margin-bottom: 8px;"><strong>Coordinates:</strong> ${(info.latitude ?? 'N/A')}, ${(info.longitude ?? 'N/A')}</div>
                        <div style="margin-top: 12px; font-size: 0.8rem; color: #9ca3af;">Source: ${info.source}</div>
                    </div>
                </div>`;
                showToast('IP lookup completed', 'success');
            } catch (error) {
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #ef4444;">
                    <strong>IP Lookup Failed</strong><br>${error.message}
                </div>`;
                showToast('IP lookup failed', 'error');
            }
        }

        // Domain/DNS Lookup
        async function lookupDNS() {
            const domain = document.getElementById('dns-domain').value.trim();
            const outputDiv = document.getElementById('dns-output');
            
            if (!domain) {
                showToast('Enter a domain', 'error');
                return;
            }
            
            outputDiv.innerHTML = '<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #3b82f6;">‚è≥ Looking up DNS...</div>';
            outputDiv.style.display = 'block';
            
            try {
                const cleanDomain = domain.replace(/^https?:\/\//, '').replace(/\/$/, '').split('/')[0];
                const types = ['A', 'AAAA', 'MX', 'TXT', 'NS', 'CNAME'];
                const results = {};
                
                for (const type of types) {
                    try {
                        const res = await fetch(`https://dns.google/resolve?name=${cleanDomain}&type=${type}`);
                        const data = await res.json();
                        if (data.Answer && data.Answer.length > 0) {
                            results[type] = data.Answer.map(a => a.data);
                        }
                    } catch (e) {}
                }
                
                let whois = '';
                if (results.A && results.A.length > 0) {
                    try {
                        const res = await fetch(`https://ipapi.co/${results.A[0]}/json/`);
                        const d = await res.json();
                        whois = `<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #374151;">
                            <strong>Server Info:</strong>
                            <div style="margin-top: 8px;">
                                <div style="margin-bottom: 5px;">Location: ${d.city}, ${d.country_name}</div>
                                <div style="margin-bottom: 5px;">ISP: ${d.org || 'Unknown'}</div>
                                <div>ASN: AS${d.asn || 'Unknown'}</div>
                            </div>
                        </div>`;
                    } catch (e) {}
                }
                
                if (Object.keys(results).length === 0) throw new Error('No DNS records found');
                
                let html = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px;">
                    <div style="background: #1f2937; padding: 15px; border-radius: 4px;">
                        <div style="margin-bottom: 15px;"><strong>Domain:</strong> ${cleanDomain}</div>`;
                
                for (const [type, records] of Object.entries(results)) {
                    html += `<div style="margin-bottom: 12px;">
                        <strong style="color: #3b82f6;">${type} Records:</strong>
                        <div style="margin-top: 5px; padding: 8px; background: #111827; border-radius: 4px;">`;
                    records.forEach(rec => {
                        html += `<div style="margin-bottom: 3px; font-family: 'JetBrains Mono', monospace; font-size: 0.875rem;">${rec}</div>`;
                    });
                    html += `</div></div>`;
                }
                
                html += whois + '</div></div>';
                outputDiv.innerHTML = html;
                showToast('DNS lookup completed', 'success');
            } catch (error) {
                outputDiv.innerHTML = `<div style="padding: 1rem; background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border); border-radius: 8px; color: #ef4444;">
                    <strong>DNS Lookup Failed</strong><br>${error.message}
                </div>`;
                showToast('DNS lookup failed', 'error');
            }
        }

        // ============= CODE PLAYGROUND =============
        
        let currentLanguage = 'javascript';
        let pyodideInstance = null;
        let sqlDb = null;
        
        const samples = {
            javascript: `// JavaScript Playground
console.log("Hello, World!");

// Try some code
const numbers = [1, 2, 3, 4, 5];
const doubled = numbers.map(n => n * 2);
console.log("Doubled:", doubled);

// Functions
function fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
}
console.log("Fibonacci(10):", fibonacci(10));`,
            
            htmlcss: `<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .card {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    h1 { color: #667eea; }
    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover { background: #764ba2; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Hello, Playground! üé®</h1>
    <p>This is a live HTML/CSS preview</p>
    <button onclick="alert('Button clicked!')">Click Me</button>
  </div>
</body>
</html>`,
            
            python: `# Python Playground (Powered by Pyodide)
print("Hello from Python! üêç")

# Lists and comprehensions
numbers = [1, 2, 3, 4, 5]
squared = [n**2 for n in numbers]
print(f"Squared: {squared}")

# Functions
def factorial(n):
    if n <= 1:
        return 1
    return n * factorial(n - 1)

print(f"Factorial(5): {factorial(5)}")

# Dictionary
person = {"name": "Alice", "age": 30}
print(f"Person: {person}")`,
            
            sql: `-- SQL Playground (SQLite in Browser)
-- Database is pre-loaded with sample data

-- Create a table
CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY,
    name TEXT NOT NULL,
    age INTEGER,
    email TEXT
);

-- Insert data
INSERT INTO users (name, age, email) VALUES 
    ('Alice', 28, 'alice@example.com'),
    ('Bob', 35, 'bob@example.com'),
    ('Charlie', 42, 'charlie@example.com');

-- Query data
SELECT * FROM users WHERE age > 30;`,
            
            typescript: `// TypeScript Playground
interface Person {
    name: string;
    age: number;
    email?: string;
}

class Developer implements Person {
    constructor(
        public name: string,
        public age: number,
        public skills: string[]
    ) {}
    
    introduce(): string {
        return \`Hi, I'm \${this.name}, \${this.age} years old. Skills: \${this.skills.join(', ')}\`;
    }
}

const dev = new Developer("Alice", 30, ["TypeScript", "React", "Node.js"]);
console.log(dev.introduce());

// Generic function
function identity<T>(arg: T): T {
    return arg;
}

console.log(identity<string>("Hello TypeScript!"));
console.log(identity<number>(42));`,
            
            json: `// JSON Query Playground
// Sample data is provided below
// Use JavaScript to query/transform JSON

const data = {
    users: [
        { id: 1, name: "Alice", age: 28, active: true },
        { id: 2, name: "Bob", age: 35, active: false },
        { id: 3, name: "Charlie", age: 42, active: true }
    ],
    metadata: {
        total: 3,
        version: "1.0"
    }
};

// Filter active users
const activeUsers = data.users.filter(u => u.active);
console.log("Active users:", activeUsers);

// Get names of users over 30
const names = data.users
    .filter(u => u.age > 30)
    .map(u => u.name);
console.log("Users over 30:", names);

// Average age
const avgAge = data.users.reduce((sum, u) => sum + u.age, 0) / data.users.length;
console.log("Average age:", avgAge);`
        };

        function initPlayground() {
            if (!document.getElementById('playground-editor').value) {
                loadSample();
            }
            setupAutocomplete();
        }

        function switchPlayground(lang) {
            currentLanguage = lang;
            
            // Update active tab
            document.querySelectorAll('#playground-page .tool-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update output label
            const labels = {
                javascript: 'Console Output',
                htmlcss: 'Live Preview',
                python: 'Python Output',
                sql: 'Query Results',
                typescript: 'Compiled Output',
                json: 'Query Results'
            };
            document.getElementById('output-label').textContent = labels[lang] || 'Output';
            
            // Load sample if editor is empty
            if (!document.getElementById('playground-editor').value.trim()) {
                loadSample();
            }
            
            clearOutput();
        }

        function loadSample() {
            document.getElementById('playground-editor').value = samples[currentLanguage] || '';
        }

        function clearPlayground() {
            document.getElementById('playground-editor').value = '';
            clearOutput();
        }

        function clearOutput() {
            document.getElementById('playground-output').innerHTML = `
                <div style="color: var(--text-muted); text-align: center; padding: 2rem;">
                    Click "Run" to execute your code...
                </div>`;
        }

        async function runPlaygroundCode() {
            const code = document.getElementById('playground-editor').value.trim();
            
            if (!code) {
                showToast('Write some code first', 'error');
                return;
            }
            
            try {
                switch (currentLanguage) {
                    case 'javascript':
                        await runJavaScript(code);
                        break;
                    case 'htmlcss':
                        await runHTMLCSS(code);
                        break;
                    case 'python':
                        await runPython(code);
                        break;
                    case 'sql':
                        await runSQL(code);
                        break;
                    case 'typescript':
                        await runTypeScript(code);
                        break;
                    case 'json':
                        await runJSONQuery(code);
                        break;
                }
            } catch (error) {
                document.getElementById('playground-output').innerHTML = `
                    <div style="color: #ef4444;">
                        <strong>‚ùå Error:</strong><br>
                        ${error.message || error}
                    </div>`;
                showToast('Execution failed', 'error');
            }
        }

        // JavaScript Runner
        async function runJavaScript(code) {
            const output = [];
            const originalConsole = {
                log: console.log,
                error: console.error,
                warn: console.warn
            };
            
            console.log = (...args) => output.push({ type: 'log', args });
            console.error = (...args) => output.push({ type: 'error', args });
            console.warn = (...args) => output.push({ type: 'warn', args });
            
            try {
                const result = eval(code);
                if (result !== undefined) {
                    output.push({ type: 'result', args: [result] });
                }
                
                let html = '';
                output.forEach(item => {
                    const color = item.type === 'error' ? '#ef4444' : 
                                  item.type === 'warn' ? '#f59e0b' : 
                                  item.type === 'result' ? '#10b981' : '#e5e7eb';
                    const prefix = item.type === 'result' ? '‚Üí ' : '> ';
                    const formatted = item.args.map(arg => 
                        typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
                    ).join(' ');
                    html += `<div style="color: ${color}; margin-bottom: 8px;">${prefix}${formatted}</div>`;
                });
                
                document.getElementById('playground-output').innerHTML = html || '<div style="color: #10b981;">‚úì Code executed successfully (no output)</div>';
                showToast('Code executed', 'success');
            } catch (error) {
                throw error;
            } finally {
                console.log = originalConsole.log;
                console.error = originalConsole.error;
                console.warn = originalConsole.warn;
            }
        }

        // HTML/CSS Runner
        async function runHTMLCSS(code) {
            const iframe = document.createElement('iframe');
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';
            iframe.style.borderRadius = '8px';
            iframe.style.background = 'white';
            
            document.getElementById('playground-output').innerHTML = '';
            document.getElementById('playground-output').appendChild(iframe);
            
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            iframeDoc.open();
            iframeDoc.write(code);
            iframeDoc.close();
            
            showToast('HTML/CSS rendered', 'success');
        }

        // Python Runner (Pyodide)
        async function runPython(code) {
            if (!pyodideInstance) {
                document.getElementById('python-notice').style.display = 'block';
                showToast('Loading Python (first time, ~6MB)...', 'info');
                
                try {
                    // Load Pyodide from CDN
                    if (!window.loadPyodide) {
                        const script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js';
                        document.head.appendChild(script);
                        
                        await new Promise((resolve, reject) => {
                            script.onload = resolve;
                            script.onerror = () => reject(new Error('Failed to load Pyodide script'));
                            setTimeout(() => reject(new Error('Pyodide load timeout')), 30000);
                        });
                    }
                    
                    pyodideInstance = await loadPyodide({
                        indexURL: 'https://cdn.jsdelivr.net/pyodide/v0.25.0/full/'
                    });
                    
                    document.getElementById('python-notice').style.display = 'none';
                    showToast('Python loaded successfully!', 'success');
                } catch (error) {
                    document.getElementById('python-notice').style.display = 'none';
                    document.getElementById('playground-output').innerHTML = `
                        <div style="color: #ef4444;">
                            <strong>‚ùå Python Environment Error:</strong><br>
                            ${error.message}<br><br>
                            <div style="margin-top: 1rem; padding: 1rem; background: rgba(239, 68, 68, 0.1); border-radius: 4px;">
                                <strong>Alternative:</strong> Python requires a large download (~6MB).<br>
                                If loading fails, try:
                                <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                                    <li>Check your internet connection</li>
                                    <li>Refresh the page and try again</li>
                                    <li>Use JavaScript for quick testing instead</li>
                                </ul>
                            </div>
                        </div>`;
                    showToast('Python load failed', 'error');
                    return;
                }
            }
            
            try {
                // Redirect Python output
                await pyodideInstance.runPythonAsync(`
import sys
import io
sys.stdout = io.StringIO()
sys.stderr = io.StringIO()
                `);
                
                // Run user code
                await pyodideInstance.runPythonAsync(code);
                
                // Get output
                const stdout = await pyodideInstance.runPythonAsync('sys.stdout.getvalue()');
                const stderr = await pyodideInstance.runPythonAsync('sys.stderr.getvalue()');
                
                let output = '';
                if (stdout) output += stdout;
                if (stderr) output += `<div style="color: #ef4444;">${stderr}</div>`;
                
                document.getElementById('playground-output').innerHTML = output ? 
                    `<div style="color: #e5e7eb; white-space: pre-wrap;">${output}</div>` : 
                    '<div style="color: #10b981;">‚úì Code executed successfully (no output)</div>';
                showToast('Python executed', 'success');
            } catch (error) {
                document.getElementById('playground-output').innerHTML = `
                    <div style="color: #ef4444;">
                        <strong>‚ùå Python Error:</strong><br>
                        <pre style="margin-top: 0.5rem; background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 4px; overflow-x: auto;">${error.message}</pre>
                    </div>`;
                showToast('Python execution failed', 'error');
            }
        }

        // SQL Runner (sql.js)
        async function runSQL(code) {
            if (!sqlDb) {
                try {
                    // Load sql.js from CDN
                    const script = document.createElement('script');
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js';
                    document.head.appendChild(script);
                    
                    await new Promise((resolve, reject) => {
                        script.onload = resolve;
                        script.onerror = reject;
                    });
                    
                    const SQL = await initSqlJs({
                        locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${file}`
                    });
                    sqlDb = new SQL.Database();
                    showToast('SQL database initialized', 'success');
                } catch (error) {
                    throw new Error('Failed to load SQL engine');
                }
            }
            
            try {
                const statements = code.split(';').filter(s => s.trim());
                let html = '';
                
                statements.forEach(stmt => {
                    if (!stmt.trim()) return;
                    
                    const result = sqlDb.exec(stmt);
                    
                    if (result.length > 0) {
                        result.forEach(table => {
                            html += '<div style="margin-bottom: 1rem; overflow-x: auto;">';
                            html += '<table style="width: 100%; border-collapse: collapse; background: #1f2937; border-radius: 4px; overflow: hidden;">';
                            html += '<thead><tr>';
                            table.columns.forEach(col => {
                                html += `<th style="padding: 8px; background: #374151; text-align: left; border-bottom: 2px solid #4b5563;">${col}</th>`;
                            });
                            html += '</tr></thead><tbody>';
                            
                            table.values.forEach((row, i) => {
                                html += `<tr style="background: ${i % 2 === 0 ? '#1f2937' : '#111827'};">`;
                                row.forEach(cell => {
                                    html += `<td style="padding: 8px; border-bottom: 1px solid #374151;">${cell}</td>`;
                                });
                                html += '</tr>';
                            });
                            
                            html += '</tbody></table></div>';
                        });
                    } else {
                        html += `<div style="color: #10b981; margin-bottom: 8px;">‚úì Query executed</div>`;
                    }
                });
                
                document.getElementById('playground-output').innerHTML = html || '<div style="color: #10b981;">‚úì SQL executed successfully</div>';
                showToast('SQL executed', 'success');
            } catch (error) {
                throw error;
            }
        }

        // TypeScript Runner
        async function runTypeScript(code) {
            try {
                // Load TypeScript compiler if not loaded
                if (!window.ts) {
                    const script = document.createElement('script');
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/typescript/5.3.3/typescript.min.js';
                    document.head.appendChild(script);
                    await new Promise((resolve, reject) => {
                        script.onload = resolve;
                        script.onerror = reject;
                    });
                }
                
                // Compile TypeScript to JavaScript
                const result = ts.transpileModule(code, {
                    compilerOptions: {
                        module: ts.ModuleKind.CommonJS,
                        target: ts.ScriptTarget.ES2015
                    }
                });
                
                // Execute compiled JavaScript
                await runJavaScript(result.outputText);
            } catch (error) {
                throw error;
            }
        }

        // JSON Query Runner
        async function runJSONQuery(code) {
            await runJavaScript(code);
        }

        // Basic Autocomplete
        function setupAutocomplete() {
            const editor = document.getElementById('playground-editor');
            const dropdown = document.getElementById('autocomplete-dropdown');
            
            const keywords = {
                javascript: ['console.log', 'function', 'const', 'let', 'var', 'if', 'else', 'for', 'while', 'return', 'class', 'async', 'await'],
                python: ['print', 'def', 'class', 'if', 'else', 'elif', 'for', 'while', 'return', 'import', 'from', 'try', 'except'],
                sql: ['SELECT', 'FROM', 'WHERE', 'INSERT', 'UPDATE', 'DELETE', 'CREATE', 'TABLE', 'JOIN', 'ORDER BY', 'GROUP BY'],
                typescript: ['interface', 'type', 'class', 'function', 'const', 'let', 'async', 'await', 'export', 'import']
            };
            
            editor.addEventListener('input', (e) => {
                const cursorPos = editor.selectionStart;
                const textBeforeCursor = editor.value.substring(0, cursorPos);
                const words = textBeforeCursor.split(/\s+/);
                const currentWord = words[words.length - 1];
                
                if (currentWord.length < 2) {
                    dropdown.style.display = 'none';
                    return;
                }
                
                const suggestions = (keywords[currentLanguage] || [])
                    .filter(kw => kw.toLowerCase().startsWith(currentWord.toLowerCase()))
                    .slice(0, 10);
                
                if (suggestions.length > 0) {
                    dropdown.innerHTML = suggestions.map(s => 
                        `<div style="padding: 8px; cursor: pointer; color: #e5e7eb;" onmouseover="this.style.background='#374151'" onmouseout="this.style.background='transparent'" onclick="insertSuggestion('${s}')">${s}</div>`
                    ).join('');
                    dropdown.style.display = 'block';
                    dropdown.style.left = '10px';
                    dropdown.style.top = (editor.offsetTop + 30) + 'px';
                } else {
                    dropdown.style.display = 'none';
                }
            });
            
            editor.addEventListener('blur', () => {
                setTimeout(() => dropdown.style.display = 'none', 200);
            });
        }

        function insertSuggestion(word) {
            const editor = document.getElementById('playground-editor');
            const cursorPos = editor.selectionStart;
            const textBeforeCursor = editor.value.substring(0, cursorPos);
            const textAfterCursor = editor.value.substring(cursorPos);
            const words = textBeforeCursor.split(/\s+/);
            words[words.length - 1] = word;
            editor.value = words.join(' ') + textAfterCursor;
            editor.focus();
            document.getElementById('autocomplete-dropdown').style.display = 'none';
        }

    </script>
    </div>
</body>
</html>

